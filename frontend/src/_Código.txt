â”‚ main.jsx
â”‚ main.txt
â”‚ â”œâ”€â”€â”€api
â”‚ â”‚ auth.js
â”‚ â”‚ tax.js
â”‚ â”œâ”€â”€â”€assets
â”‚ â”‚ react.svg
â”‚ â”‚ â”œâ”€â”€â”€images
â”‚ â”‚ â”‚ avatar.jpg
â”‚ â”œâ”€â”€â”€components
â”‚ â”‚ â”œâ”€â”€â”€auth
â”‚ â”‚ â”‚ LoginForm.jsx
â”‚ â”‚ â”‚ ProtectedRoute.jsx
â”‚ â”‚ â”œâ”€â”€â”€common
â”‚ â”‚ â”‚ Button.jsx
â”‚ â”‚ â”‚ Input.jsx
â”‚ â”‚ â”‚ PermissionGuard.jsx
â”‚ â”‚ â”œâ”€â”€â”€ui
â”‚ â”‚ â”‚ Navbar.jsx
â”‚ â”‚ â”‚ SideBar.jsx
â”‚ â”‚ â”‚ TopNavbar.jsx
â”‚ â”œâ”€â”€â”€contexts
â”‚ â”‚ AuthContext.jsx
â”‚ â”œâ”€â”€â”€features
â”‚ â”‚ â”œâ”€â”€â”€convocatorias
â”‚ â”‚ â”‚ â”œâ”€â”€â”€api
â”‚ â”‚ â”‚ â”‚ convocatorias.js
â”‚ â”‚ â”‚ â”œâ”€â”€â”€pages
â”‚ â”‚ â”‚ â”‚ CandidatosListPage.jsx
â”‚ â”‚ â”‚ â”‚ ConvocatoriasListPage.jsx
â”‚ â”‚ â”‚ â”‚ EntrevistasListPage.jsx
â”‚ â”‚ â”‚ â”‚ PostulacionesListPage.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€styles
â”‚ â”‚ â”œâ”€â”€â”€employees
â”‚ â”‚ â”‚ â”œâ”€â”€â”€components
â”‚ â”‚ â”‚ â”‚ DashboardWidget.jsx
â”‚ â”‚ â”‚ â”‚ NotificationBell.jsx
â”‚ â”‚ â”‚ â”‚ PaystubDownloadWidget.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€pages
â”‚ â”‚ â”‚ â”‚ DashboardPage.jsx
â”‚ â”‚ â”‚ â”‚ EditProfilePage.jsx
â”‚ â”‚ â”‚ â”‚ PayrollSelfServicePage.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€styles
â”‚ â”‚ â”œâ”€â”€â”€payroll
â”‚ â”‚ â”‚ â”œâ”€â”€â”€api
â”‚ â”‚ â”‚ â”‚ attendances.js
â”‚ â”‚ â”‚ â”‚ employees.js
â”‚ â”‚ â”‚ â”‚ payroll.js
â”‚ â”‚ â”‚ â”‚ payslips.js
â”‚ â”‚ â”‚ â”œâ”€â”€â”€components
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€common
â”‚ â”‚ â”‚ â”‚ â”‚ ConceptAffectationForm.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ ConceptAffectionsFrom.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ DataSummaryCard.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ PayrollCalendar.jsx
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€masters
â”‚ â”‚ â”‚ â”‚ â”‚ EmployeePayrollDetails.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ LegalParametersTable.jsx
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€outputs
â”‚ â”‚ â”‚ â”‚ â”‚ BankExportButton.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ PaystubUploader.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ PlameExportButton.jsx
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€processes
â”‚ â”‚ â”‚ â”‚ â”‚ MonthlyNoveltyEntry.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ PrePayrollReviewTable.jsx
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€reports
â”‚ â”‚ â”‚ â”‚ â”‚ OutputFilesPage.jsx
â”‚ â”‚ â”‚ â”‚ â”‚ PayrollSummaryReportPage.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€hooks
â”‚ â”‚ â”‚ â”‚ usePayrollCalculations.js
â”‚ â”‚ â”‚ â”œâ”€â”€â”€pages
â”‚ â”‚ â”‚ â”‚ EmployeeDetailPage.jsx
â”‚ â”‚ â”‚ â”‚ EmployeeFormPage.jsx
â”‚ â”‚ â”‚ â”‚ EmployeeListPage.jsx
â”‚ â”‚ â”‚ â”‚ LiquidationProcessPage.jsx
â”‚ â”‚ â”‚ â”‚ MastersConfigPage.jsx
â”‚ â”‚ â”‚ â”‚ PayrollDashboardPage.jsx
â”‚ â”‚ â”‚ â”‚ PayrollDetailPage.jsx
â”‚ â”‚ â”‚ â”‚ PayrollFormPage.jsx
â”‚ â”‚ â”‚ â”‚ PayrollListPage.jsx
â”‚ â”‚ â”‚ â”‚ ReportsPage.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€styles
â”‚ â”‚ â”œâ”€â”€â”€tax
â”‚ â”‚ â”‚ â”œâ”€â”€â”€pages
â”‚ â”‚ â”‚ â”‚ DailyOpsPage.jsx
â”‚ â”‚ â”‚ â”‚ MonthlyClosingPage.jsx
â”‚ â”‚ â”‚ â”‚ TaxConfigPage.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€â”€styles
â”‚ â”œâ”€â”€â”€hooks
â”‚ â”‚ useAuth.js
â”‚ â”‚ usePermissions.js
â”‚ â”œâ”€â”€â”€layouts
â”‚ â”‚ AuthenticatedDashboardLayout.jsx
â”‚ â”œâ”€â”€â”€pages
â”‚ â”‚ NotFoundPage.jsx
â”‚ â”‚ â”œâ”€â”€â”€auth
â”‚ â”‚ â”‚ LoginPage.jsx
â”‚ â”œâ”€â”€â”€routes
â”‚ â”‚ AuthenticatedAppRoutes.jsx
â”‚ â”œâ”€â”€â”€styles

### main.jsx
'''
import React from 'react';
import ReactDOM from 'react-dom/client';
import AuthenticatedAppRoutes from './routes/AuthenticatedAppRoutes.jsx';
import './styles/global.css'; // Importa tus estilos globales

console.log('ğŸš€ AplicaciÃ³n iniciando...');

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <AuthenticatedAppRoutes />
  </React.StrictMode>
);

'''

### main.txt
'''
import os
import re

output_file = "_CÃ³digo.txt"
ENCODINGS_TO_TRY = ["utf-8", "utf-8-sig", "cp1252", "latin-1"]

def is_binary_file(path, bytes_to_check=1024):
    """Chequea si un archivo parece binario leyendo sus primeros bytes."""
    try:
        with open(path, "rb") as f:
            chunk = f.read(bytes_to_check)
            if b'\x00' in chunk:
                return True
            # HeurÃ­stica simple: si hay muchos bytes fuera de rango ASCII, no es binario necesariamente.
            return False
    except Exception:
        return True

def read_text_file(path):
    """Intenta leer un archivo probando varias codificaciones. Lanza excepciÃ³n si no es legible."""
    if is_binary_file(path):
        raise UnicodeDecodeError("binary", b"", 0, 1, "archivo binario detectado")

    last_exc = None
    for enc in ENCODINGS_TO_TRY:
        try:
            with open(path, "r", encoding=enc) as f:
                return f.read()
        except Exception as e:
            last_exc = e
            continue
    # Si todas fallaron, lanzar la Ãºltima excepciÃ³n para informar
    raise last_exc if last_exc is not None else UnicodeDecodeError("unknown", b"", 0, 1, "no se pudo leer")

def limpiar_html(content):
    """Elimina las secciones <style>...</style> de un archivo HTML."""
    return re.sub(r'<style\b[^>]*>.*?</style>', '', content, flags=re.DOTALL | re.IGNORECASE)

def generate_tree(start_path, include_test, include_html):
    """Genera una vista tipo Ã¡rbol desde start_path"""
    tree_lines = []
    for root, dirs, files in os.walk(start_path):
        # Omitir carpeta 'test' si no se incluye
        if 'test' in dirs and not include_test:
            dirs.remove('test')
        
        # Filtrar archivos segÃºn configuraciÃ³n y excluir main.py
        files = [f for f in files if f != "main.py"]
        if 'resources' in root and not include_html:
            files = [f for f in files if not f.endswith('.html')]
        
        dirs.sort()
        files.sort()

        level = root.replace(start_path, '').count(os.sep)
        indent = 'â”‚ ' * level + 'â”œâ”€â”€â”€' if level > 0 else ''
        
        dirname = os.path.basename(root) or os.path.abspath(root)
        if level > 0:
            tree_lines.append(f"{indent}{dirname}")
        
        for f in files:
            if not f.endswith(".css"):
                sub_indent = 'â”‚ ' * (level + 1)
                tree_lines.append(f"{sub_indent}{f}")
    
    return "\n".join(tree_lines)

def process_files(start_path, include_test, include_html):
    """Lee todos los archivos (excepto .css y main.py) y devuelve bloques formateados.
       Imprime en consola el estado por archivo."""
    code_blocks = []
    
    for root, dirs, files in os.walk(start_path):
        if 'test' in dirs and not include_test:
            dirs.remove('test')
        
        files = [f for f in files if f != "main.py"]
        if 'resources' in root and not include_html:
            files = [f for f in files if not f.endswith('.html')]

        for file in sorted(files):
            if file.endswith(".css"):
                print(f"[SKIP] {file}: archivo .css excluido.")
                continue
            
            file_path = os.path.join(root, file)
            relative_path = os.path.relpath(file_path, start_path).replace("\\", "/")
            
            try:
                content = read_text_file(file_path)
                if file.endswith(".html"):
                    content = limpiar_html(content)
                block = f"### {relative_path}\n'''\n{content}\n'''\n"
                code_blocks.append(block)
                print(f"[OK] {relative_path}: leÃ­do correctamente.")
            except UnicodeDecodeError as e:
                print(f"[SKIP] {relative_path}: no es archivo de texto o codificaciÃ³n no soportada ({e}).")
            except Exception as e:
                print(f"[ERROR] {relative_path}: error al leer ({e}).")
    
    return "\n".join(code_blocks)

def ask_user_for_inclusion():
    include_test = input("Â¿Deseas incluir los archivos dentro de la carpeta 'test'? (y/n): ").strip().lower() == 'y'
    include_html = input("Â¿Deseas incluir los archivos .html dentro de la carpeta 'resources'? (y/n): ").strip().lower() == 'y'
    return include_test, include_html

def main():
    start_path = os.getcwd()
    
    include_test, include_html = ask_user_for_inclusion()
    
    tree_output = generate_tree(start_path, include_test, include_html)
    files_output = process_files(start_path, include_test, include_html)
    
    with open(os.path.join(start_path, output_file), 'w', encoding='utf-8') as f:
        f.write(tree_output + "\n\n" + files_output)
    
    print(f"Archivo '{output_file}' generado correctamente.")

if __name__ == "__main__":
    main()

'''

### api/auth.js
'''

'''

### api/tax.js
'''
import { useAuth } from '../hooks/useAuth';

// Hook personalizado para obtener el cliente de API autenticado
export const useApiClient = () => {
  const { token, logout } = useAuth();

  const getAuthHeaders = () => ({
    'Authorization': `Bearer ${token}`,
  });

  const getAuthHeadersJson = () => ({
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`,
  });

  const handleResponse = async (response) => {
    if (response.status === 401 || response.status === 403) {
      logout();
      throw new Error('SesiÃ³n invÃ¡lida o expirada.');
    }
    if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.message || 'Error en la solicitud');
    }
    return response.json();
  };

  const API_URL = 'http://localhost:8081/api/tax';

  return {
    // --- Proceso 1: ConfiguraciÃ³n ---
    getConfiguracion: () => 
        fetch(`${API_URL}/config`, {
            method: 'GET',
            headers: getAuthHeaders(),
        }).then(handleResponse),

    guardarContribuyente: (data) =>
        fetch(`${API_URL}/config/contribuyente`, {
            method: 'POST',
            headers: getAuthHeadersJson(),
            body: JSON.stringify(data),
        }).then(handleResponse),

    guardarParametros: (data) =>
        fetch(`${API_URL}/config/parametros`, {
            method: 'POST',
            headers: getAuthHeadersJson(),
            body: JSON.stringify(data),
        }).then(handleResponse),
    
    subirCatalogo: (formData) =>
        fetch(`${API_URL}/config/catalogo`, {
            method: 'POST',
            headers: getAuthHeaders(), // No 'Content-Type', el navegador lo pone con FormData
            body: formData,
        }).then(handleResponse),

    // --- Proceso 2: OperaciÃ³n Diaria ---
    registrarVenta: (data) =>
        fetch(`${API_URL}/daily/venta`, {
            method: 'POST',
            headers: getAuthHeadersJson(),
            body: JSON.stringify(data),
        }).then(handleResponse),
    
    registrarCompra: (formData) =>
        fetch(`${API_URL}/daily/compra`, {
            method: 'POST',
            headers: getAuthHeaders(),
            body: formData,
        }).then(handleResponse),

    // --- Proceso 3: Cierre Mensual ---
    iniciarCierre: (periodo) =>
        fetch(`${API_URL}/closing/iniciar`, {
            method: 'POST',
            headers: getAuthHeadersJson(),
            body: JSON.stringify({ periodo }),
        }).then(handleResponse),

    aprobarDeclaracion: (declaracionId, aprobado) =>
        fetch(`${API_URL}/closing/aprobar`, {
            method: 'POST',
            headers: getAuthHeadersJson(),
            body: JSON.stringify({ declaracionId, aprobado }),
        }).then(handleResponse),
  };
};
'''

### assets/react.svg
'''
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
'''

### components/auth/LoginForm.jsx
'''
import React, { useState } from 'react';
import { useAuth } from '../../hooks/useAuth';
import { useNavigate } from 'react-router-dom';
import Button from '../common/Button';
import Input from '../common/Input';
import './LoginForm.css';

const LoginForm = () => {
  console.log('ğŸ¯ LoginForm component is rendering');
  
  const [formData, setFormData] = useState({
    email: '',
    password: ''
  });
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  
  const { login } = useAuth();
  const navigate = useNavigate();
  
  console.log('ğŸ¯ LoginForm hooks initialized, login function:', typeof login);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
    // Limpiar error cuando el usuario empiece a escribir
    if (error) setError('');
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    console.log('ğŸ” Iniciando login con datos:', formData);

    try {
      const result = await login(formData);
      console.log('ğŸ” Resultado del login:', result);
      
      if (result.success) {
        console.log('âœ… Login exitoso, redireccionando...');
        // Redireccionar al dashboard despuÃ©s del login exitoso
        navigate('/dashboard');
      } else {
        console.log('âŒ Error en login:', result.error);
        setError(result.error || 'Error durante el login');
      }
    } catch (err) {
      console.log('âŒ ExcepciÃ³n durante login:', err);
      setError('Error de conexiÃ³n. Intente nuevamente.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="login-form-container">
      <div className="login-form-card">
        <div className="login-header">
          <div className="login-logo">
            <h1>SISAC-ERP</h1>
            <p>Sistema Integral de AdministraciÃ³n Contable</p>
          </div>
        </div>
        
        <form onSubmit={handleSubmit} className="login-form">
          <div className="form-group">
            <Input
              type="email"
              name="email"
              placeholder="Correo electrÃ³nico"
              value={formData.email}
              onChange={handleChange}
              required
              disabled={loading}
              icon="âœ‰ï¸"
            />
          </div>

          <div className="form-group">
            <Input
              type="password"
              name="password"
              placeholder="ContraseÃ±a"
              value={formData.password}
              onChange={handleChange}
              required
              disabled={loading}
              icon="ğŸ”’"
            />
          </div>

          {error && (
            <div className="error-message">
              <span>âš ï¸ {error}</span>
            </div>
          )}

          <Button
            type="submit"
            variant="primary"
            disabled={loading || !formData.email || !formData.password}
            fullWidth
          >
            {loading ? 'Iniciando sesiÃ³n...' : 'Iniciar SesiÃ³n'}
          </Button>
        </form>

        <div className="login-footer">
          <div className="test-credentials">
            <h4>Credenciales de Prueba:</h4>
            <div className="credential-item">
              <strong>GestiÃ³n Tributaria:</strong> tributario@sisac.com / admin123
            </div>
            <div className="credential-item">
              <strong>Pago de Planilla:</strong> planilla@sisac.com / admin123
            </div>
            <div className="credential-item">
              <strong>ContrataciÃ³n:</strong> contratacion@sisac.com / admin123
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default LoginForm;
'''

### components/auth/ProtectedRoute.jsx
'''
import React from 'react';
import { Navigate, useLocation } from 'react-router-dom';
import { useAuth } from '../../hooks/useAuth';

const ProtectedRoute = ({ children, requiredRole = null, requiredPermission = null }) => {
  const { isAuthenticated, loading, hasRole, hasPermission } = useAuth();
  const location = useLocation();

  // Mostrar loading mientras se valida la autenticaciÃ³n
  if (loading) {
    return (
      <div className="loading-container">
        <div className="loading-spinner">
          <div className="spinner"></div>
          <p>Verificando autenticaciÃ³n...</p>
        </div>
      </div>
    );
  }

  // Si no estÃ¡ autenticado, redirigir al login
  if (!isAuthenticated) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  // Si se requiere un rol especÃ­fico y el usuario no lo tiene
  if (requiredRole && !hasRole(requiredRole)) {
    return (
      <div className="access-denied">
        <div className="access-denied-content">
          <h2>Acceso Denegado</h2>
          <p>No tienes permisos para acceder a esta secciÃ³n.</p>
          <p>Rol requerido: <strong>{requiredRole}</strong></p>
          <button onClick={() => window.history.back()}>Volver</button>
        </div>
      </div>
    );
  }

  // Si se requiere un permiso especÃ­fico y el usuario no lo tiene
  if (requiredPermission && !hasPermission(requiredPermission)) {
    return (
      <div className="access-denied">
        <div className="access-denied-content">
          <h2>Acceso Denegado</h2>
          <p>No tienes permisos para acceder a esta funcionalidad.</p>
          <p>Permiso requerido: <strong>{requiredPermission}</strong></p>
          <button onClick={() => window.history.back()}>Volver</button>
        </div>
      </div>
    );
  }

  // Si todas las validaciones pasan, mostrar el contenido
  return children;
};

export default ProtectedRoute;
'''

### components/common/Button.jsx
'''
import React from 'react';
import '@styles/Button.css'; // Crea este archivo CSS

const Button = ({ children, onClick, type = 'button', className = '' }) => {
    return (
        <button type={type} onClick={onClick} className={`btn ${className}`}>
            {children}
        </button>
    );
};

export default Button;
'''

### components/common/Input.jsx
'''
import React from 'react';
import '@styles/Input.css'; // Crea este archivo CSS

const Input = ({ label, type = 'text', name, value, onChange, required, className = '' }) => {
    return (
        <div className={`input-group ${className}`}>
            <label htmlFor={name}>{label}</label>
            <input
                type={type}
                id={name}
                name={name}
                value={value}
                onChange={onChange}
                required={required}
            />
        </div>
    );
};

export default Input;
'''

### components/common/PermissionGuard.jsx
'''
import React from 'react';
import { usePermissions } from '../../hooks/usePermissions';

const PermissionGuard = ({ 
  children, 
  permission = null, 
  permissions = [], 
  role = null, 
  roles = [], 
  requireAll = false,
  fallback = null 
}) => {
  const { hasPermission, hasAnyPermission, hasRole, hasAnyRole } = usePermissions();

  // Verificar permisos individuales
  if (permission && !hasPermission(permission)) {
    console.log(`ğŸš« [PermissionGuard] Permiso denegado: "${permission}"`);
    return fallback;
  }
  
  if (permission) {
    console.log(`âœ… [PermissionGuard] Permiso concedido: "${permission}"`);
  }

  // Verificar lista de permisos
  if (permissions.length > 0) {
    const hasRequiredPermissions = requireAll 
      ? permissions.every(p => hasPermission(p))
      : hasAnyPermission(permissions);
      
    if (!hasRequiredPermissions) {
      return fallback;
    }
  }

  // Verificar rol individual
  if (role && !hasRole(role)) {
    return fallback;
  }

  // Verificar lista de roles
  if (roles.length > 0 && !hasAnyRole(roles)) {
    return fallback;
  }

  // Si todas las validaciones pasan, mostrar el contenido
  return children;
};

export default PermissionGuard;
'''

### components/ui/Navbar.jsx
'''
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import NotificationBell from '@components/NotificationBell.jsx'; // Importamos el nuevo componente

const Navbar = ({ user, onLogout }) => {
    const [showProfileMenu, setShowProfileMenu] = useState(false);
    const navigate = useNavigate();

    const handleLogout = () => {
        if (window.confirm('Â¿EstÃ¡s seguro de que quieres cerrar sesiÃ³n?')) {
            onLogout();
            navigate('/login');
        }
    };

    return (
        <header className="navbar">
            <div className="navbar-logo">
                <h2>SISAC</h2>
            </div>
            <div className="navbar-user">
                {/* ... (cÃ³digo existente del perfil de usuario) ... */}
                <span className="user-name">
                    {user?.firstName} {user?.lastName}
                </span>

                <div
                    className="profile-container"
                    onMouseEnter={() => setShowProfileMenu(true)}
                    onMouseLeave={() => setShowProfileMenu(false)}
                >
                    <img
                        src={user?.profilePic || "/src/assets/images/default-avatar.png"}
                        alt="Perfil"
                        className="profile-mini"
                    />
                    {showProfileMenu && (
                        <div className="profile-menu">
                            <button onClick={() => navigate('/dashboard/edit-profile')}>
                                Editar Perfil
                            </button>
                            {/* Â¡Nueva opciÃ³n agregada! */}
                            <button onClick={() => navigate('/dashboard/payroll-selfservice')}>
                                Mi NÃ³mina
                            </button>
                            <button onClick={handleLogout}>Cerrar SesiÃ³n</button>
                        </div>
                    )}
                </div>
                {/* Usamos el nuevo componente */}
                <NotificationBell />
            </div>
        </header>
    );
};

export default Navbar;
'''

### components/ui/SideBar.jsx
'''
// src/ui/Sidebar.jsx
import React, { useState } from 'react';
import { Link, useLocation } from 'react-router-dom';
import { useAuth } from '../../hooks/useAuth';
import PermissionGuard from '../common/PermissionGuard';

// ConfiguraciÃ³n de navegaciÃ³n por rol
const getNavigationByRole = (role) => {
  switch(role) {
    case 'ADMIN_TRIBUTARIO':
      return [
        { 
          name: 'Dashboard', 
          path: '/dashboard', 
          icon: 'ğŸ“Š',
          permission: 'view_dashboard'
        },
        { 
          name: 'ConfiguraciÃ³n Tributaria', 
          path: '/tax/config', 
          icon: 'âš™ï¸',
          permission: 'manage_tax_config'
        },
        { 
          name: 'OperaciÃ³n Diaria', 
          path: '/tax/daily', 
          icon: 'ğŸ“…',
          permission: 'manage_daily_operations'
        },
        { 
          name: 'Cierre Mensual', 
          path: '/tax/closing', 
          icon: 'ğŸ“‹',
          permission: 'manage_monthly_closing'
        }
      ];
    
    case 'GESTOR_PLANILLA':
      return [
        { 
          name: 'Dashboard', 
          path: '/payroll/dashboard', 
          icon: 'ğŸ“Š',
          permission: 'view_dashboard'
        },
        { 
          name: 'GestiÃ³n de Planillas', 
          path: '/payroll/list', 
          icon: 'ğŸ“‹',
          permission: 'view_dashboard'
        },
        { 
          name: 'GestiÃ³n Empleados', 
          path: '/masters/employees', 
          icon: 'ğŸ‘¥',
          permission: 'manage_legal_parameters'
        },
        { 
          name: 'Maestros y Config', 
          path: '/masters/config', 
          icon: 'âš™ï¸',
          permission: 'manage_legal_parameters'
        },
        { 
          name: 'Ingreso Novedades', 
          path: '/payroll/novelties', 
          icon: 'âœï¸',
          permission: 'manage_payroll_novelties'
        },
        { 
          name: 'RevisiÃ³n Pre-NÃ³mina', 
          path: '/payroll/review', 
          icon: 'â˜‘ï¸',
          permission: 'review_pre_payroll'
        },
        { 
          name: 'Resumen Planilla', 
          path: '/reports/summary', 
          icon: 'ğŸ“Š',
          permission: 'view_dashboard'
        },
        { 
          name: 'Archivos de Salida', 
          path: '/reports/output-files', 
          icon: 'ğŸ’¾',
          permission: 'view_dashboard'
        }
      ];
    
    case 'GESTOR_CONTRATACION':
      return [
        { 
          name: 'Dashboard', 
          path: '/dashboard', 
          icon: 'ğŸ“Š',
          permission: 'view_dashboard'
        },
        { 
          name: 'Convocatorias', 
          path: '/hiring/convocatorias', 
          icon: 'ğŸ“¢',
          permission: 'manage_job_postings'
        },
        { 
          name: 'Candidatos', 
          path: '/hiring/candidatos', 
          icon: 'ğŸ‘¥',
          permission: 'manage_candidates'
        },
        { 
          name: 'Postulaciones', 
          path: '/hiring/postulaciones', 
          icon: 'ğŸ“',
          permission: 'manage_candidates'
        },
        { 
          name: 'Entrevistas', 
          path: '/hiring/entrevistas', 
          icon: 'ğŸ’¬',
          permission: 'manage_interviews'
        }
      ];
    
    default: 
      return [
        { 
          name: 'Dashboard', 
          path: '/dashboard', 
          icon: 'ğŸ“Š',
          permission: 'view_dashboard'
        }
      ];
  }
};

const Sidebar = () => {
    const [isCollapsed, setIsCollapsed] = useState(false);
    const { user, userRole } = useAuth();
    const location = useLocation();
    
    console.log('ğŸ” [Sidebar] Usuario:', user);
    console.log('ğŸ” [Sidebar] Rol:', userRole);
    
    const navigation = getNavigationByRole(userRole);
    console.log('ğŸ” [Sidebar] Items de navegaciÃ³n:', navigation);
    navigation.forEach((item, index) => {
        console.log(`  ${index + 1}. ${item.name} - ${item.path} - Permiso: ${item.permission}`);
    });

    const toggleSidebar = () => {
        setIsCollapsed(!isCollapsed);
    };

    return (
        <aside className={`sidebar ${isCollapsed ? 'collapsed' : ''}`}>
            <div className="sidebar-header">
                <div className="sidebar-logo">
                    <h2>{isCollapsed ? 'S' : 'SISAC'}</h2>
                    {!isCollapsed && <span className="sidebar-subtitle">ERP</span>}
                </div>
                <button 
                    className="sidebar-toggle"
                    onClick={toggleSidebar}
                    aria-label="Toggle sidebar"
                >
                    {isCollapsed ? 'â–¶' : 'â—€'}
                </button>
            </div>

            <nav className="sidebar-nav">
                <div className="nav-section">
                    {!isCollapsed && (
                        <div className="nav-section-title">
                            <span>MÃ³dulo: {user?.rolDescripcion}</span>
                        </div>
                    )}
                    
                    <ul className="nav-list">
                        {navigation.map((item, index) => (
                            <PermissionGuard key={index} permission={item.permission}>
                                <li className="nav-item">
                                    <Link 
                                        to={item.path} 
                                        className={`nav-link ${location.pathname === item.path ? 'active' : ''}`}
                                        title={isCollapsed ? item.name : ''}
                                    >
                                        <span className="nav-icon">{item.icon}</span>
                                        {!isCollapsed && (
                                            <span className="nav-text">{item.name}</span>
                                        )}
                                    </Link>
                                </li>
                            </PermissionGuard>
                        ))}
                    </ul>
                </div>

                {!isCollapsed && (
                    <div className="sidebar-footer">
                        <div className="user-info">
                            <div className="user-avatar">
                                {user?.nombreCompleto?.charAt(0) || 'U'}
                            </div>
                            <div className="user-details">
                                <span className="user-name">{user?.nombreCompleto}</span>
                                <span className="user-role">{user?.rolDescripcion}</span>
                            </div>
                        </div>
                    </div>
                )}
            </nav>
        </aside>
    );
};

export default Sidebar;
'''

### components/ui/TopNavbar.jsx
'''
import React, { useState, useRef, useEffect } from 'react';
import { useAuth } from '../../hooks/useAuth';
import { useNavigate } from 'react-router-dom';
import './TopNavbar.css';

const TopNavbar = () => {
  const [dropdownOpen, setDropdownOpen] = useState(false);
  const { user, logout } = useAuth();
  const navigate = useNavigate();
  const dropdownRef = useRef(null);

  // Cerrar dropdown al hacer click fuera
  useEffect(() => {
    const handleClickOutside = (event) => {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {
        setDropdownOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  }, []);

  const handleLogout = () => {
    logout();
    navigate('/login');
  };

  const handleProfileClick = () => {
    navigate('/profile');
    setDropdownOpen(false);
  };

  const toggleDropdown = () => {
    setDropdownOpen(!dropdownOpen);
  };

  return (
    <header className="top-navbar">
      <div className="navbar-content">
        {/* TÃ­tulo de la secciÃ³n actual */}
        <div className="navbar-title">
          <h1>Sistema Integral de AdministraciÃ³n Contable</h1>
          <span className="navbar-subtitle">
            MÃ³dulo: {user?.rolDescripcion || 'Cargando...'}
          </span>
        </div>

        {/* SecciÃ³n derecha con usuario */}
        <div className="navbar-right">
          {/* Notificaciones (placeholder) */}
          <div className="navbar-notifications">
            <button className="notification-btn" title="Notificaciones">
              <span className="notification-icon">ğŸ””</span>
              <span className="notification-badge">3</span>
            </button>
          </div>

          {/* InformaciÃ³n del usuario */}
          <div className="navbar-user" ref={dropdownRef}>
            <button 
              className="user-button"
              onClick={toggleDropdown}
              aria-expanded={dropdownOpen}
              aria-haspopup="true"
            >
              <div className="user-avatar">
                {user?.nombreCompleto?.charAt(0) || 'U'}
              </div>
              <div className="user-info">
                <span className="user-name">
                  {user?.nombreCompleto || 'Usuario'}
                </span>
                <span className="user-role">
                  {user?.rol || 'Sin rol'}
                </span>
              </div>
              <span className={`dropdown-arrow ${dropdownOpen ? 'open' : ''}`}>
                â–¼
              </span>
            </button>

            {/* Dropdown Menu */}
            {dropdownOpen && (
              <div className="user-dropdown">
                <div className="dropdown-header">
                  <div className="dropdown-user-info">
                    <strong>{user?.nombreCompleto}</strong>
                    <small>{user?.email}</small>
                  </div>
                </div>
                
                <div className="dropdown-divider"></div>
                
                <button 
                  className="dropdown-item"
                  onClick={handleProfileClick}
                >
                  <span className="dropdown-icon">ğŸ‘¤</span>
                  Mi Perfil
                </button>
                
                <button 
                  className="dropdown-item"
                  onClick={() => {
                    // AquÃ­ podrÃ­as aÃ±adir lÃ³gica para configuraciÃ³n
                    setDropdownOpen(false);
                  }}
                >
                  <span className="dropdown-icon">âš™ï¸</span>
                  ConfiguraciÃ³n
                </button>
                
                <div className="dropdown-divider"></div>
                
                <button 
                  className="dropdown-item logout-item"
                  onClick={handleLogout}
                >
                  <span className="dropdown-icon">ğŸšª</span>
                  Cerrar SesiÃ³n
                </button>
              </div>
            )}
          </div>
        </div>
      </div>
    </header>
  );
};

export default TopNavbar;
'''

### contexts/AuthContext.jsx
'''
import React, { createContext, useState, useContext, useEffect } from 'react';

// DefiniciÃ³n de permisos por rol
const ROLE_PERMISSIONS = {
  ADMIN_TRIBUTARIO: [
    'view_dashboard',
    'manage_tax_config',
    'manage_daily_operations',
    'manage_monthly_closing',
    'view_tax_reports'
  ],
  GESTOR_PLANILLA: [
    'view_dashboard',
    'manage_legal_parameters',
    'manage_payroll_novelties',
    'review_pre_payroll',
    'generate_payroll_reports',
    'manage_output_files'
  ],
  GESTOR_CONTRATACION: [
    'view_dashboard',
    'manage_job_postings',
    'manage_candidates',
    'manage_interviews',
    'manage_employees',
    'view_hiring_reports'
  ]
};

// Crear el contexto
const AuthContext = createContext();

// Exportar el contexto para uso en hooks
export { AuthContext };

// Proveedor del contexto de autenticaciÃ³n
export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [token, setToken] = useState(localStorage.getItem('token'));
  const [loading, setLoading] = useState(true);
  const [isAuthenticated, setIsAuthenticated] = useState(false);

  // FunciÃ³n para hacer login
  const login = async (credentials) => {
    console.log('ğŸš€ AuthContext: Iniciando peticiÃ³n de login:', credentials);
    
    try {
      console.log('ğŸŒ Enviando peticiÃ³n a: http://localhost:8081/api/auth/login');
      
      const response = await fetch('http://localhost:8081/api/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(credentials),
      });

      console.log('ğŸ“¡ Respuesta recibida - Status:', response.status, 'OK:', response.ok);

      if (response.ok) {
        const data = await response.json();
        console.log('âœ… Datos del login exitoso:', data);
        
        // Guardar token en localStorage
        localStorage.setItem('token', data.token);
        setToken(data.token);
        
        // Crear objeto de usuario
        const userData = {
          id: data.userId,
          email: data.email,
          nombreCompleto: data.nombreCompleto,
          rol: data.rol,
          rolDescripcion: data.rolDescripcion,
          permissions: ROLE_PERMISSIONS[data.rol] || []
        };
        
        setUser(userData);
        setIsAuthenticated(true);
        
        return { success: true, user: userData };
      } else {
        const errorData = await response.json();
        console.log('âŒ Error del servidor:', response.status, errorData);
        return { success: false, error: errorData.message || 'Error de login' };
      }
    } catch (error) {
      console.error('âŒ Error durante el login (excepciÃ³n):', error);
      return { success: false, error: 'Error de conexiÃ³n' };
    }
  };

  // FunciÃ³n para hacer logout
  const logout = () => {
    localStorage.removeItem('token');
    setToken(null);
    setUser(null);
    setIsAuthenticated(false);
  };

  // FunciÃ³n para validar token existente
  const validateToken = async () => {
    if (!token) {
      setLoading(false);
      return;
    }

    try {
      const response = await fetch('http://localhost:8081/api/auth/validate', {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json',
        },
      });

      if (response.ok) {
        const userData = await response.json();
        
        // Crear objeto de usuario con permisos
        const userWithPermissions = {
          id: userData.userId,
          email: userData.email,
          nombreCompleto: userData.nombreCompleto,
          rol: userData.rol,
          rolDescripcion: userData.rolDescripcion,
          permissions: ROLE_PERMISSIONS[userData.rol] || []
        };
        
        setUser(userWithPermissions);
        setIsAuthenticated(true);
      } else {
        // Token invÃ¡lido, limpiar datos
        logout();
      }
    } catch (error) {
      console.error('Error validando token:', error);
      logout();
    } finally {
      setLoading(false);
    }
  };

  // FunciÃ³n para obtener informaciÃ³n del usuario
  const getUserInfo = async () => {
    if (!token) return null;

    try {
      const response = await fetch('http://localhost:8081/api/auth/user-info', {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json',
        },
      });

      if (response.ok) {
        const userData = await response.json();
        return userData;
      }
    } catch (error) {
      console.error('Error obteniendo informaciÃ³n del usuario:', error);
    }
    return null;
  };

  // FunciÃ³n para verificar permisos
  const hasPermission = (permission) => {
    if (!user || !user.permissions) return false;
    return user.permissions.includes(permission);
  };

  // FunciÃ³n para verificar mÃºltiples permisos
  const hasAnyPermission = (permissions) => {
    if (!user || !user.permissions) return false;
    return permissions.some(permission => user.permissions.includes(permission));
  };

  // FunciÃ³n para verificar rol especÃ­fico
  const hasRole = (role) => {
    if (!user) return false;
    return user.rol === role;
  };

  // FunciÃ³n para verificar si tiene alguno de los roles especificados
  const hasAnyRole = (roles) => {
    if (!user) return false;
    return roles.includes(user.rol);
  };

  // Efecto para validar token al cargar
  useEffect(() => {
    validateToken();
  }, [token]);

  // Valor del contexto
  const contextValue = {
    user,
    token,
    loading,
    isAuthenticated,
    login,
    logout,
    validateToken,
    getUserInfo,
    hasPermission,
    hasAnyPermission,
    hasRole,
    hasAnyRole,
    // Datos adicionales Ãºtiles
    permissions: user?.permissions || [],
    userRole: user?.rol,
    userName: user?.nombreCompleto,
    userEmail: user?.email
  };

  return (
    <AuthContext.Provider value={contextValue}>
      {children}
    </AuthContext.Provider>
  );
};
'''

### features/convocatorias/api/convocatorias.js
'''
import axios from 'axios';

const API_BASE_URL = 'http://localhost:8081/api';

// Configurar axios instance con interceptores para JWT
const apiClient = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Interceptor para agregar token JWT automÃ¡ticamente
apiClient.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// API para Convocatorias
export const convocatoriasApi = {
  // Obtener todas las convocatorias
  getAll: () => apiClient.get('/convocatorias'),
  
  // Obtener convocatoria por ID
  getById: (id) => apiClient.get(`/convocatorias/${id}`),
  
  // Crear nueva convocatoria
  create: (convocatoria) => apiClient.post('/convocatorias', convocatoria),
  
  // Actualizar convocatoria
  update: (id, convocatoria) => apiClient.put(`/convocatorias/${id}`, convocatoria),
  
  // Eliminar convocatoria
  delete: (id) => apiClient.delete(`/convocatorias/${id}`),
};

// API para Candidatos
export const candidatosApi = {
  // Obtener todos los candidatos
  getAll: () => apiClient.get('/candidatos'),
  
  // Obtener candidato por ID
  getById: (id) => apiClient.get(`/candidatos/${id}`),
  
  // Obtener candidato por email
  getByEmail: (email) => apiClient.get(`/candidatos/email/${email}`),
  
  // Crear nuevo candidato
  create: (candidato) => apiClient.post('/candidatos', candidato),
  
  // Actualizar candidato
  update: (id, candidato) => apiClient.put(`/candidatos/${id}`, candidato),
  
  // Eliminar candidato
  delete: (id) => apiClient.delete(`/candidatos/${id}`),
};

// API para Postulaciones
export const postulacionesApi = {
  // Obtener todas las postulaciones
  getAll: () => apiClient.get('/postulaciones'),
  
  // Obtener postulaciÃ³n por ID
  getById: (id) => apiClient.get(`/postulaciones/${id}`),
  
  // Crear nueva postulaciÃ³n
  create: (postulacion) => apiClient.post('/postulaciones', postulacion),
  
  // Actualizar postulaciÃ³n
  update: (id, postulacion) => apiClient.put(`/postulaciones/${id}`, postulacion),
  
  // Eliminar postulaciÃ³n
  delete: (id) => apiClient.delete(`/postulaciones/${id}`),
  
  // Postular candidato a convocatoria
  postular: (candidatoId, convocatoriaId) => 
    apiClient.post('/postulaciones/postular', { candidatoId, convocatoriaId }),
};

// API para Entrevistas
export const entrevistasApi = {
  // Obtener todas las entrevistas
  getAll: () => apiClient.get('/entrevistas'),
  
  // Obtener entrevista por ID
  getById: (id) => apiClient.get(`/entrevistas/${id}`),
  
  // Crear nueva entrevista
  create: (entrevista) => apiClient.post('/entrevistas', entrevista),
  
  // Actualizar entrevista
  update: (id, entrevista) => apiClient.put(`/entrevistas/${id}`, entrevista),
  
  // Eliminar entrevista
  delete: (id) => apiClient.delete(`/entrevistas/${id}`),
  
  // Programar entrevista
  programar: (postulacionId, entrevista) => 
    apiClient.post('/entrevistas/programar', { postulacionId, ...entrevista }),
};

export default {
  convocatorias: convocatoriasApi,
  candidatos: candidatosApi,
  postulaciones: postulacionesApi,
  entrevistas: entrevistasApi,
};
'''

### features/convocatorias/pages/CandidatosListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { candidatosApi } from '../api/convocatorias';
import '../styles/Convocatorias.css';

export default function CandidatosListPage() {
    const [candidatos, setCandidatos] = useState([]);
    const [formData, setFormData] = useState({
        id: '',
        nombresApellidos: '',
        email: '',
        telefono: '',
        cvAdjunto: ''
    });
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    useEffect(() => {
        fetchCandidatos();
    }, []);

    const fetchCandidatos = async () => {
        setLoading(true);
        setError(null);
        try {
            const response = await candidatosApi.getAll();
            setCandidatos(response.data);
        } catch (err) {
            setError(`Error al cargar candidatos: ${err.message}`);
            console.error(err);
        } finally {
            setLoading(false);
        }
    };

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            if (formData.id) {
                await candidatosApi.update(formData.id, formData);
                alert('âœ… Candidato actualizado');
            } else {
                await candidatosApi.create(formData);
                alert('âœ… Candidato creado');
            }
            setFormData({ id: '', nombresApellidos: '', email: '', telefono: '', cvAdjunto: '' });
            await fetchCandidatos();
        } catch (err) {
            setError(`âŒ No se pudo guardar: ${err.message}`);
            alert(`Error: ${err.message}`);
        } finally {
            setLoading(false);
        }
    };

    const handleEdit = (candidato) => {
        setFormData({
            id: candidato.id,
            nombresApellidos: candidato.nombresApellidos,
            email: candidato.email,
            telefono: candidato.telefono,
            cvAdjunto: candidato.cvAdjunto || ''
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    const handleDelete = async (id) => {
        if (!confirm('Â¿Eliminar este candidato?')) return;
        try {
            await candidatosApi.delete(id);
            await fetchCandidatos();
            alert('âœ… Candidato eliminado');
        } catch (err) {
            alert(`No se pudo eliminar: ${err.message}`);
        }
    };

    return (
        <div className="convocatorias-page">
            <h1>ğŸ‘¤ GestiÃ³n de Candidatos</h1>

            {error && <div className="error-message">{error}</div>}

            <div className="form-container">
                <h2>{formData.id ? 'âœï¸ Editar Candidato' : 'â• Nuevo Candidato'}</h2>
                <form onSubmit={handleSubmit}>
                    <div className="form-row">
                        <div className="form-group">
                            <label>ID Candidato</label>
                            <input
                                type="text"
                                name="id"
                                value={formData.id}
                                onChange={handleChange}
                                placeholder="Ingrese ID"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>Nombres y Apellidos</label>
                            <input
                                type="text"
                                name="nombresApellidos"
                                value={formData.nombresApellidos}
                                onChange={handleChange}
                                placeholder="Ingrese nombres completos"
                                required
                            />
                        </div>
                    </div>
                    <div className="form-row">
                        <div className="form-group">
                            <label>Email</label>
                            <input
                                type="email"
                                name="email"
                                value={formData.email}
                                onChange={handleChange}
                                placeholder="Ingrese email"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>TelÃ©fono</label>
                            <input
                                type="text"
                                name="telefono"
                                value={formData.telefono}
                                onChange={handleChange}
                                placeholder="Ingrese telÃ©fono"
                                required
                            />
                        </div>
                    </div>
                    <div className="form-group">
                        <label>Enlace al CV (Google Docs, etc.)</label>
                        <input
                            type="url"
                            name="cvAdjunto"
                            value={formData.cvAdjunto}
                            onChange={handleChange}
                            placeholder="https://docs.google.com/document/d/..."
                        />
                    </div>
                    <div className="form-actions">
                        <button type="submit" className="btn-primary" disabled={loading}>
                            {loading ? 'Guardando...' : formData.id ? 'Actualizar' : 'Guardar'}
                        </button>
                        {formData.id && (
                            <button
                                type="button"
                                className="btn-secondary"
                                onClick={() => setFormData({ id: '', nombresApellidos: '', email: '', telefono: '', cvAdjunto: '' })}
                            >
                                Cancelar EdiciÃ³n
                            </button>
                        )}
                    </div>
                </form>
            </div>

            <div className="table-container">
                <div className="table-header">
                    <h2>ğŸ‘¥ Lista de Candidatos</h2>
                    {loading && <span className="loading-text">Cargando...</span>}
                </div>
                {candidatos.length === 0 ? (
                    <p className="no-data">No hay candidatos registrados.</p>
                ) : (
                    <div className="cards-container">
                        {candidatos.map((cand) => (
                            <div className="card" key={cand.id}>
                                <div className="card-header-content">
                                    <h3>{cand.nombresApellidos}</h3>
                                    <p className="card-meta">
                                        ID: {cand.id} | ğŸ“§ {cand.email}
                                    </p>
                                    <p className="card-meta">
                                        ğŸ“ {cand.telefono}
                                    </p>
                                    {cand.cvAdjunto && (
                                        <a
                                            href={cand.cvAdjunto}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            className="btn-link"
                                        >
                                            ğŸ“„ Ver CV
                                        </a>
                                    )}
                                </div>
                                <div className="card-actions">
                                    <button className="btn-edit" onClick={() => handleEdit(cand)}>
                                        âœï¸ Editar
                                    </button>
                                    <button className="btn-delete" onClick={() => handleDelete(cand.id)}>
                                        ğŸ—‘ï¸ Eliminar
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                )}
            </div>
        </div>
    );
}

'''

### features/convocatorias/pages/ConvocatoriasListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { convocatoriasApi } from '../api/convocatorias';
import '../styles/Convocatorias.css';

export default function ConvocatoriasListPage() {
    const [convocatorias, setConvocatorias] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);
    const [formData, setFormData] = useState({
        id: '',
        titulo: '',
        fechaPublicacion: '',
        descripcion: ''
    });

    useEffect(() => {
        fetchConvocatorias();
    }, []);

    const fetchConvocatorias = async () => {
        setLoading(true);
        setError(null);
        try {
            const response = await convocatoriasApi.getAll();
            setConvocatorias(response.data);
        } catch (err) {
            setError(`Error al cargar convocatorias: ${err.message}`);
            console.error(err);
        } finally {
            setLoading(false);
        }
    };

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            if (formData.id) {
                await convocatoriasApi.update(formData.id, formData);
                alert('âœ… Convocatoria actualizada');
            } else {
                await convocatoriasApi.create(formData);
                alert('âœ… Convocatoria creada');
            }
            setFormData({ id: '', titulo: '', fechaPublicacion: '', descripcion: '' });
            await fetchConvocatorias();
        } catch (err) {
            setError(`âŒ No se pudo guardar: ${err.message}`);
            alert(`Error: ${err.message}`);
        } finally {
            setLoading(false);
        }
    };

    const handleEdit = (conv) => {
        setFormData({ ...conv });
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    const handleDelete = async (id) => {
        if (!confirm('Â¿Eliminar esta convocatoria?')) return;
        try {
            await convocatoriasApi.delete(id);
            await fetchConvocatorias();
            alert('âœ… Convocatoria eliminada');
        } catch (err) {
            alert(`No se pudo eliminar: ${err.message}`);
        }
    };

    return (
        <div className="convocatorias-page">
            <h1>ğŸ“‹ GestiÃ³n de Convocatorias</h1>

            {error && <div className="error-message">{error}</div>}

            <div className="form-container">
                <h2>{formData.id ? 'âœï¸ Editar Convocatoria' : 'â• Nueva Convocatoria'}</h2>
                <form onSubmit={handleSubmit}>
                    <div className="form-row">
                        <div className="form-group">
                            <label>ID Convocatoria</label>
                            <input
                                type="text"
                                name="id"
                                value={formData.id}
                                onChange={handleChange}
                                placeholder="CONV-2025-001"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>Fecha de PublicaciÃ³n</label>
                            <input
                                type="date"
                                name="fechaPublicacion"
                                value={formData.fechaPublicacion}
                                onChange={handleChange}
                                required
                            />
                        </div>
                    </div>
                    <div className="form-group">
                        <label>TÃ­tulo</label>
                        <input
                            type="text"
                            name="titulo"
                            value={formData.titulo}
                            onChange={handleChange}
                            placeholder="Convocatoria para Desarrollador Backend"
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>DescripciÃ³n</label>
                        <textarea
                            name="descripcion"
                            rows="3"
                            value={formData.descripcion}
                            onChange={handleChange}
                            placeholder="Detalles de la convocatoria..."
                        />
                    </div>
                    <div className="form-actions">
                        <button type="submit" className="btn-primary" disabled={loading}>
                            {loading ? 'Guardando...' : formData.id ? 'Actualizar' : 'Guardar'}
                        </button>
                        {formData.id && (
                            <button
                                type="button"
                                className="btn-secondary"
                                onClick={() => setFormData({ id: '', titulo: '', fechaPublicacion: '', descripcion: '' })}
                            >
                                Cancelar EdiciÃ³n
                            </button>
                        )}
                    </div>
                </form>
            </div>

            <div className="table-container">
                <div className="table-header">
                    <h2>ğŸ“‹ Lista de Convocatorias</h2>
                    {loading && <span className="loading-text">Cargando...</span>}
                </div>
                {convocatorias.length === 0 ? (
                    <p className="no-data">No hay convocatorias registradas.</p>
                ) : (
                    <div className="cards-container">
                        {convocatorias.map((conv) => (
                            <div className="card" key={conv.id}>
                                <div className="card-header-content">
                                    <h3>{conv.titulo}</h3>
                                    <p className="card-meta">
                                        ID: {conv.id} | Fecha: {new Date(conv.fechaPublicacion).toLocaleDateString()}
                                    </p>
                                    <p className="card-description">
                                        {conv.descripcion?.substring(0, 150)}
                                        {conv.descripcion?.length > 150 ? '...' : ''}
                                    </p>
                                </div>
                                <div className="card-actions">
                                    <button className="btn-edit" onClick={() => handleEdit(conv)}>
                                        âœï¸ Editar
                                    </button>
                                    <button className="btn-delete" onClick={() => handleDelete(conv.id)}>
                                        ğŸ—‘ï¸ Eliminar
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                )}
            </div>
        </div>
    );
}

'''

### features/convocatorias/pages/EntrevistasListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { entrevistasApi, convocatoriasApi, candidatosApi } from '../api/convocatorias';
import '../styles/Convocatorias.css';

export default function EntrevistasListPage() {
    const [entrevistas, setEntrevistas] = useState([]);
    const [formData, setFormData] = useState({
        id: '',
        convocatoriaId: '',
        candidatoId: '',
        nombreEvaluador: '',
        resultado: '',
        fechaEvaluacion: '',
        observaciones: ''
    });
    const [convocatorias, setConvocatorias] = useState([]);
    const [candidatos, setCandidatos] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    useEffect(() => {
        fetchEntrevistas();
        fetchConvocatorias();
        fetchCandidatos();
    }, []);

    const fetchEntrevistas = async () => {
        setLoading(true);
        setError(null);
        try {
            const response = await entrevistasApi.getAll();
            setEntrevistas(response.data);
        } catch (err) {
            setError(`Error al cargar entrevistas: ${err.message}`);
            console.error(err);
        } finally {
            setLoading(false);
        }
    };

    const fetchConvocatorias = async () => {
        try {
            const response = await convocatoriasApi.getAll();
            setConvocatorias(response.data);
        } catch (err) {
            console.error('Error:', err);
        }
    };

    const fetchCandidatos = async () => {
        try {
            const response = await candidatosApi.getAll();
            setCandidatos(response.data);
        } catch (err) {
            console.error('Error:', err);
        }
    };

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            if (formData.id) {
                await entrevistasApi.update(formData.id, formData);
                alert('âœ… Entrevista actualizada');
            } else {
                await entrevistasApi.create(formData);
                alert('âœ… Entrevista creada');
            }
            setFormData({
                id: '',
                convocatoriaId: '',
                candidatoId: '',
                nombreEvaluador: '',
                resultado: '',
                fechaEvaluacion: '',
                observaciones: ''
            });
            await fetchEntrevistas();
        } catch (err) {
            setError(`âŒ No se pudo guardar: ${err.message}`);
            alert(`Error: ${err.message}`);
        } finally {
            setLoading(false);
        }
    };

    const handleEdit = (entrevista) => {
        setFormData({
            id: entrevista.id,
            convocatoriaId: entrevista.convocatoriaId || '',
            candidatoId: entrevista.candidatoId || '',
            nombreEvaluador: entrevista.nombreEvaluador || '',
            resultado: entrevista.resultado || '',
            fechaEvaluacion: entrevista.fechaEvaluacion || '',
            observaciones: entrevista.observaciones || ''
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    const handleDelete = async (id) => {
        if (!confirm('Â¿Eliminar esta entrevista?')) return;
        try {
            await entrevistasApi.delete(id);
            await fetchEntrevistas();
            alert('âœ… Entrevista eliminada');
        } catch (err) {
            alert(`No se pudo eliminar: ${err.message}`);
        }
    };

    return (
        <div className="convocatorias-page">
            <h1>ğŸ¤ GestiÃ³n de Entrevistas</h1>

            {error && <div className="error-message">{error}</div>}

            <div className="form-container">
                <h2>{formData.id ? 'âœï¸ Editar Entrevista' : 'â• Nueva Entrevista'}</h2>
                <form onSubmit={handleSubmit}>
                    <div className="form-row">
                        <div className="form-group">
                            <label>ID Entrevista</label>
                            <input
                                type="text"
                                name="id"
                                value={formData.id}
                                onChange={handleChange}
                                placeholder="Ingrese ID"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>Convocatoria</label>
                            <select
                                name="convocatoriaId"
                                value={formData.convocatoriaId}
                                onChange={handleChange}
                                required
                            >
                                <option value="">Seleccione una convocatoria</option>
                                {convocatorias.map(conv => (
                                    <option key={conv.id} value={conv.id}>
                                        {conv.titulo}
                                    </option>
                                ))}
                            </select>
                        </div>
                    </div>
                    <div className="form-row">
                        <div className="form-group">
                            <label>Candidato</label>
                            <select
                                name="candidatoId"
                                value={formData.candidatoId}
                                onChange={handleChange}
                                required
                            >
                                <option value="">Seleccione un candidato</option>
                                {candidatos.map(cand => (
                                    <option key={cand.id} value={cand.id}>
                                        {cand.nombresApellidos}
                                    </option>
                                ))}
                            </select>
                        </div>
                        <div className="form-group">
                            <label>Nombre del Evaluador</label>
                            <input
                                type="text"
                                name="nombreEvaluador"
                                value={formData.nombreEvaluador}
                                onChange={handleChange}
                                placeholder="Ingrese nombre del evaluador"
                                required
                            />
                        </div>
                    </div>
                    <div className="form-row">
                        <div className="form-group">
                            <label>Resultado</label>
                            <input
                                type="text"
                                name="resultado"
                                value={formData.resultado}
                                onChange={handleChange}
                                placeholder="Resultado de la entrevista"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>Fecha de EvaluaciÃ³n</label>
                            <input
                                type="date"
                                name="fechaEvaluacion"
                                value={formData.fechaEvaluacion}
                                onChange={handleChange}
                                required
                            />
                        </div>
                    </div>
                    <div className="form-group">
                        <label>Observaciones</label>
                        <textarea
                            name="observaciones"
                            rows="3"
                            value={formData.observaciones}
                            onChange={handleChange}
                            placeholder="Ingrese observaciones"
                        />
                    </div>
                    <div className="form-actions">
                        <button type="submit" className="btn-primary" disabled={loading}>
                            {loading ? 'Guardando...' : formData.id ? 'Actualizar' : 'Guardar'}
                        </button>
                        {formData.id && (
                            <button
                                type="button"
                                className="btn-secondary"
                                onClick={() => setFormData({
                                    id: '',
                                    convocatoriaId: '',
                                    candidatoId: '',
                                    nombreEvaluador: '',
                                    resultado: '',
                                    fechaEvaluacion: '',
                                    observaciones: ''
                                })}
                            >
                                Cancelar EdiciÃ³n
                            </button>
                        )}
                    </div>
                </form>
            </div>

            <div className="table-container">
                <div className="table-header">
                    <h2>ğŸ“‹ Lista de Entrevistas</h2>
                    {loading && <span className="loading-text">Cargando...</span>}
                </div>
                {entrevistas.length === 0 ? (
                    <p className="no-data">No hay entrevistas registradas.</p>
                ) : (
                    <div className="cards-container">
                        {entrevistas.map((ent) => {
                            const candidato = candidatos.find(c => c.id === ent.candidatoId);
                            const convocatoria = convocatorias.find(c => c.id === ent.convocatoriaId);
                            return (
                                <div className="card" key={ent.id}>
                                    <div className="card-header-content">
                                        <h3>{candidato ? candidato.nombresApellidos : 'Candidato no encontrado'}</h3>
                                        <p className="card-meta">
                                            ID: {ent.id} | Fecha: {new Date(ent.fechaEvaluacion).toLocaleDateString()}
                                        </p>
                                        <p className="card-meta">
                                            Convocatoria: {convocatoria ? convocatoria.titulo : 'N/A'}
                                        </p>
                                        <p className="card-meta">
                                            Evaluador: {ent.nombreEvaluador}
                                        </p>
                                        <p className="card-meta">
                                            Resultado: <strong>{ent.resultado}</strong>
                                        </p>
                                        {ent.observaciones && (
                                            <p className="card-description">{ent.observaciones}</p>
                                        )}
                                    </div>
                                    <div className="card-actions">
                                        <button className="btn-edit" onClick={() => handleEdit(ent)}>
                                            âœï¸ Editar
                                        </button>
                                        <button className="btn-delete" onClick={() => handleDelete(ent.id)}>
                                            ğŸ—‘ï¸ Eliminar
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                )}
            </div>
        </div>
    );
}

'''

### features/convocatorias/pages/PostulacionesListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { postulacionesApi, convocatoriasApi, candidatosApi } from '../api/convocatorias';
import '../styles/Convocatorias.css';

export default function PostulacionesListPage() {
    const [postulaciones, setPostulaciones] = useState([]);
    const [formData, setFormData] = useState({
        id: '',
        convocatoriaId: '',
        candidatoId: '',
        fechaEvaluacion: '',
        estado: 'En Proceso',
        observaciones: ''
    });
    const [convocatorias, setConvocatorias] = useState([]);
    const [candidatos, setCandidatos] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    useEffect(() => {
        fetchPostulaciones();
        fetchConvocatorias();
        fetchCandidatos();
    }, []);

    const fetchPostulaciones = async () => {
        setLoading(true);
        setError(null);
        try {
            const response = await postulacionesApi.getAll();
            setPostulaciones(response.data);
        } catch (err) {
            setError(`Error al cargar postulaciones: ${err.message}`);
            console.error(err);
        } finally {
            setLoading(false);
        }
    };

    const fetchConvocatorias = async () => {
        try {
            const response = await convocatoriasApi.getAll();
            setConvocatorias(response.data);
        } catch (err) {
            console.error('Error:', err);
        }
    };

    const fetchCandidatos = async () => {
        try {
            const response = await candidatosApi.getAll();
            setCandidatos(response.data);
        } catch (err) {
            console.error('Error:', err);
        }
    };

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            if (formData.id) {
                await postulacionesApi.update(formData.id, formData);
                alert('âœ… PostulaciÃ³n actualizada');
            } else {
                await postulacionesApi.create(formData);
                alert('âœ… PostulaciÃ³n creada');
            }
            setFormData({
                id: '',
                convocatoriaId: '',
                candidatoId: '',
                fechaEvaluacion: '',
                estado: 'En Proceso',
                observaciones: ''
            });
            await fetchPostulaciones();
        } catch (err) {
            setError(`âŒ No se pudo guardar: ${err.message}`);
            alert(`Error: ${err.message}`);
        } finally {
            setLoading(false);
        }
    };

    const handleEdit = (postulacion) => {
        setFormData({
            id: postulacion.id,
            convocatoriaId: postulacion.convocatoriaId || '',
            candidatoId: postulacion.candidatoId || '',
            fechaEvaluacion: postulacion.fechaEvaluacion || '',
            estado: postulacion.estado || 'En Proceso',
            observaciones: postulacion.observaciones || ''
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    const handleDelete = async (id) => {
        if (!confirm('Â¿Eliminar esta postulaciÃ³n?')) return;
        try {
            await postulacionesApi.delete(id);
            await fetchPostulaciones();
            alert('âœ… PostulaciÃ³n eliminada');
        } catch (err) {
            alert(`No se pudo eliminar: ${err.message}`);
        }
    };

    return (
        <div className="convocatorias-page">
            <h1>ğŸ“ GestiÃ³n de Postulaciones</h1>

            {error && <div className="error-message">{error}</div>}

            <div className="form-container">
                <h2>{formData.id ? 'âœï¸ Editar PostulaciÃ³n' : 'â• Nueva PostulaciÃ³n'}</h2>
                <form onSubmit={handleSubmit}>
                    <div className="form-row">
                        <div className="form-group">
                            <label>ID PostulaciÃ³n</label>
                            <input
                                type="text"
                                name="id"
                                value={formData.id}
                                onChange={handleChange}
                                placeholder="Ingrese ID"
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label>Convocatoria</label>
                            <select
                                name="convocatoriaId"
                                value={formData.convocatoriaId}
                                onChange={handleChange}
                                required
                            >
                                <option value="">Seleccione una convocatoria</option>
                                {convocatorias.map(conv => (
                                    <option key={conv.id} value={conv.id}>
                                        {conv.titulo}
                                    </option>
                                ))}
                            </select>
                        </div>
                    </div>
                    <div className="form-row">
                        <div className="form-group">
                            <label>Candidato</label>
                            <select
                                name="candidatoId"
                                value={formData.candidatoId}
                                onChange={handleChange}
                                required
                            >
                                <option value="">Seleccione un candidato</option>
                                {candidatos.map(cand => (
                                    <option key={cand.id} value={cand.id}>
                                        {cand.nombresApellidos}
                                    </option>
                                ))}
                            </select>
                        </div>
                        <div className="form-group">
                            <label>Fecha de EvaluaciÃ³n</label>
                            <input
                                type="date"
                                name="fechaEvaluacion"
                                value={formData.fechaEvaluacion}
                                onChange={handleChange}
                                required
                            />
                        </div>
                    </div>
                    <div className="form-row">
                        <div className="form-group">
                            <label>Estado de PostulaciÃ³n</label>
                            <select
                                name="estado"
                                value={formData.estado}
                                onChange={handleChange}
                                required
                            >
                                <option value="En Proceso">En Proceso</option>
                                <option value="Aceptado">Aceptado</option>
                                <option value="Rechazado">Rechazado</option>
                            </select>
                        </div>
                    </div>
                    <div className="form-group">
                        <label>Observaciones</label>
                        <textarea
                            name="observaciones"
                            rows="3"
                            value={formData.observaciones}
                            onChange={handleChange}
                            placeholder="Ingrese observaciones"
                        />
                    </div>
                    <div className="form-actions">
                        <button type="submit" className="btn-primary" disabled={loading}>
                            {loading ? 'Guardando...' : formData.id ? 'Actualizar' : 'Guardar'}
                        </button>
                        {formData.id && (
                            <button
                                type="button"
                                className="btn-secondary"
                                onClick={() => setFormData({
                                    id: '',
                                    convocatoriaId: '',
                                    candidatoId: '',
                                    fechaEvaluacion: '',
                                    estado: 'En Proceso',
                                    observaciones: ''
                                })}
                            >
                                Cancelar EdiciÃ³n
                            </button>
                        )}
                    </div>
                </form>
            </div>

            <div className="table-container">
                <div className="table-header">
                    <h2>ğŸ“‹ Lista de Postulaciones</h2>
                    {loading && <span className="loading-text">Cargando...</span>}
                </div>
                {postulaciones.length === 0 ? (
                    <p className="no-data">No hay postulaciones registradas.</p>
                ) : (
                    <div className="cards-container">
                        {postulaciones.map((post) => {
                            const candidato = candidatos.find(c => c.id === post.candidatoId);
                            const convocatoria = convocatorias.find(c => c.id === post.convocatoriaId);
                            return (
                                <div className="card" key={post.id}>
                                    <div className="card-header-content">
                                        <h3>{candidato ? candidato.nombresApellidos : 'Sin nombre'}</h3>
                                        <p className="card-meta">
                                            ID: {post.id} | Fecha: {new Date(post.fechaEvaluacion).toLocaleDateString()}
                                        </p>
                                        <p className="card-meta">
                                            Convocatoria: {convocatoria ? convocatoria.titulo : 'N/A'}
                                        </p>
                                        <p className="card-meta">
                                            Estado: <strong>{post.estado}</strong>
                                        </p>
                                        {post.observaciones && (
                                            <p className="card-description">{post.observaciones}</p>
                                        )}
                                    </div>
                                    <div className="card-actions">
                                        <button className="btn-edit" onClick={() => handleEdit(post)}>
                                            âœï¸ Editar
                                        </button>
                                        <button className="btn-delete" onClick={() => handleDelete(post.id)}>
                                            ğŸ—‘ï¸ Eliminar
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                )}
            </div>
        </div>
    );
}

'''

### features/employees/components/DashboardWidget.jsx
'''
import React from 'react';

const DashboardWidget = ({ title, content, icon }) => {
  return (
    <div className="dashboard-widget">
      <div className="widget-header">
        {icon && <span className="widget-icon">{icon}</span>}
        <h3>{title}</h3>
      </div>
      <div className="widget-content">
        {content}
      </div>
    </div>
  );
};

export default DashboardWidget;
'''

### features/employees/components/NotificationBell.jsx
'''
import React, { useState } from 'react';

const NotificationBell = () => {
    const [showNotifications, setShowNotifications] = useState(false);

    // ** LÃ³gica de notificaciones, idealmente fetch del API **
    const notifications = [
        { id: 1, message: 'Nueva solicitud de acceso pendiente.' },
        { id: 2, message: 'ActualizaciÃ³n en el sistema de planillas.' }
    ];

    return (
        <div
            className="notification-container"
            onClick={() => setShowNotifications(!showNotifications)}
        >
            <span className="notification-bell">ğŸ””</span>
            {notifications.length > 0 && (
                <span className="notification-badge">{notifications.length}</span>
            )}
            {showNotifications && (
                <div className="notifications-dropdown">
                    {notifications.length > 0 ? (
                        <ul>
                            {notifications.map((notif) => (
                                <li key={notif.id}>{notif.message}</li>
                            ))}
                        </ul>
                    ) : (
                        <p>No hay notificaciones nuevas.</p>
                    )}
                </div>
            )}
        </div>
    );
};

export default NotificationBell;
'''

### features/employees/components/PaystubDownloadWidget.jsx
'''
import React, { useState } from 'react';
import { ReceiptText, Download } from 'lucide-react';

/**
 * Componente para mostrar boletas y permitir la descarga.
 * @param {{paystubs: Array<{id: number, period: string, amount: number}>}} props
 */
const PaystubDownloadWidget = ({ paystubs }) => {
    const [loading, setLoading] = useState(false);

    const showMessage = (message) => console.log(`[Message Box]: ${message}`);

    const handleDownload = (period) => {
        setLoading(true);
        showMessage(`Descargando boleta de ${period}...`);
        setTimeout(() => {
            setLoading(false);
            showMessage(`Boleta de ${period} descargada con Ã©xito.`);
        }, 1500);
    };

    return (
        <div className="bg-white p-6 rounded-xl shadow-xl w-full">
            <h3 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <ReceiptText className="w-6 h-6 mr-2 text-indigo-600" />
                Mis Boletas ElectrÃ³nicas
            </h3>
            <div className="space-y-4">
                {paystubs.map((stub) => (
                    <div key={stub.id} className="flex items-center justify-between p-3 border-b last:border-b-0">
                        <div className="flex flex-col">
                            <span className="font-semibold text-gray-700">{stub.period}</span>
                            <span className="text-sm text-gray-500">Monto Neto: S/ {stub.amount.toFixed(2)}</span>
                        </div>
                        {/* Se ajusta el estilo del botÃ³n */}
                        <button
                            onClick={() => handleDownload(stub.period)}
                            disabled={loading}
                            className={`flex items-center justify-center p-2 rounded-lg transition font-medium ${loading ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-600 text-white hover:bg-green-700'}`}
                        >
                            {/* Texto solo en pantallas grandes */}
                            <span className="hidden sm:inline">Descargar</span>
                            <Download className="w-4 h-4 sm:ml-2" />
                        </button>
                    </div>
                ))}
            </div>
            {paystubs.length === 0 && <p className="text-gray-500 text-center py-4">AÃºn no hay boletas disponibles.</p>}
        </div>
    );
};

export default PaystubDownloadWidget;
'''

### features/employees/pages/DashboardPage.jsx
'''
import React from 'react';
import { useAuth } from '../../../hooks/useAuth';
import '../styles/DashboardPage.css';

const DashboardPage = () => {
    const { user } = useAuth();
    
    // ** SimulaciÃ³n de datos para los widgets **
    const getDashboardData = () => {
        switch(user?.rol) {
            case 'ADMIN_TRIBUTARIO':
                return {
                    title: 'GestiÃ³n Tributaria',
                    stats: [
                        { label: 'Declaraciones Pendientes', value: 15, icon: 'ğŸ“„' },
                        { label: 'Comprobantes Procesados', value: 245, icon: 'âœ…' },
                        { label: 'Alertas Tributarias', value: 3, icon: 'âš ï¸' }
                    ]
                };
            case 'GESTOR_PLANILLA':
                return {
                    title: 'GestiÃ³n de Planilla',
                    stats: [
                        { label: 'Empleados Activos', value: 150, icon: 'ğŸ‘¥' },
                        { label: 'Planillas Procesadas', value: 12, icon: 'ğŸ“Š' },
                        { label: 'Novedades Pendientes', value: 8, icon: 'ğŸ“' }
                    ]
                };
            case 'GESTOR_CONTRATACION':
                return {
                    title: 'GestiÃ³n de ContrataciÃ³n',
                    stats: [
                        { label: 'Postulantes Nuevos', value: 25, icon: 'ğŸ‘¤' },
                        { label: 'Entrevistas Programadas', value: 7, icon: 'ğŸ’¬' },
                        { label: 'Contrataciones del Mes', value: 4, icon: 'âœ¨' }
                    ]
                };
            default:
                return {
                    title: 'Dashboard General',
                    stats: []
                };
        }
    };

    const dashboardData = getDashboardData();

    return (
        <div className="page-content fade-in">
            <div className="page-header">
                <h1>Bienvenido al Dashboard de SISAC</h1>
                <p>MÃ³dulo: {dashboardData.title} - {user?.nombreCompleto}</p>
            </div>
            
            <div className="dashboard-cards">
                {dashboardData.stats.map((stat, index) => (
                    <div key={index} className="dashboard-card">
                        <div className="card-header">
                            <h3 className="card-title">{stat.label}</h3>
                            <div className="card-icon">
                                {stat.icon}
                            </div>
                        </div>
                        <div className="card-value">{stat.value}</div>
                        <p className="card-description">
                            {stat.label} en el sistema actual
                        </p>
                    </div>
                ))}
            </div>

            <div className="dashboard-info">
                <div className="info-card">
                    <h3>InformaciÃ³n del Usuario</h3>
                    <div className="info-grid">
                        <div className="info-item">
                            <label>Nombre:</label>
                            <span>{user?.nombreCompleto}</span>
                        </div>
                        <div className="info-item">
                            <label>Email:</label>
                            <span>{user?.email}</span>
                        </div>
                        <div className="info-item">
                            <label>Rol:</label>
                            <span>{user?.rolDescripcion}</span>
                        </div>
                        <div className="info-item">
                            <label>Permisos:</label>
                            <span>{user?.permissions?.length || 0} permisos asignados</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default DashboardPage;
'''

### features/employees/pages/EditProfilePage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import '@styles_e/DashboardPage.css';
import '@styles_e/EditProfile.css';
import Input from '@common/Input.jsx'; // Importa el componente Input
import Button from '@common/Button.jsx'; // Importa el componente Button

const EditProfilePage = ({ user, setUser }) => {
    // Cargar el estado inicial del usuario desde las props o localStorage
    const [profileData, setProfileData] = useState(() => {
        const storedProfile = localStorage.getItem('userProfile');
        return storedProfile ? JSON.parse(storedProfile) : (user || {});
    });
    
    const [showPassword, setShowPassword] = useState(false);
    const navigate = useNavigate();

    // Actualizar el localStorage cada vez que profileData cambie
    useEffect(() => {
        // Aseguramos que solo se guarde cuando haya datos de usuario
        if (profileData && Object.keys(profileData).length > 0) {
            localStorage.setItem('userProfile', JSON.stringify(profileData));
        }
    }, [profileData]);

    const handleChange = (e) => {
        const { name, value } = e.target;
        setProfileData({ ...profileData, [name]: value });
    };

    const handleFileChange = (e) => {
        const file = e.target.files[0];
        if (file) {
            if (file.size > 2 * 1024 * 1024) { // 2MB
                alert('La foto es demasiado grande. Por favor, elige una mÃ¡s pequeÃ±a.');
                return;
            }
            const reader = new FileReader();
            reader.onloadend = () => {
                setProfileData({ ...profileData, profilePic: reader.result });
            };
            reader.readAsDataURL(file);
        }
    };

    const handleSave = (e) => {
        e.preventDefault();
        setUser(profileData);
        alert('Perfil actualizado con Ã©xito.');
        navigate('/dashboard');
    };
    
    const handleGoBack = () => {
        navigate(-1); // Regresa a la pÃ¡gina anterior
    };

    return (
        <div className="edit-profile-container">
            <Button onClick={handleGoBack} className="go-back-button">â† Volver</Button>
            <h1>Editar Perfil</h1>
            <form onSubmit={handleSave}>
                <div className="profile-photo-section">
                    <label htmlFor="profile-upload" className="profile-photo-label">
                        <img
                            src={profileData.profilePic || "/src/assets/images/default-avatar.png"}
                            alt="Foto de Perfil"
                            className="profile-photo"
                        />
                        <span className="edit-icon">âœï¸</span>
                    </label>
                    <input
                        id="profile-upload"
                        type="file"
                        accept="image/png, image/jpeg"
                        onChange={handleFileChange}
                        style={{ display: 'none' }}
                    />
                </div>

                <div className="input-row">
                    <Input
                        label="Nombre:"
                        name="firstName"
                        value={profileData.firstName || ''}
                        onChange={handleChange}
                        required
                    />
                    <Input
                        label="Apellido:"
                        name="lastName"
                        value={profileData.lastName || ''}
                        onChange={handleChange}
                        required
                    />
                </div>

                <div className="input-row">
                    <Input
                        label="TelÃ©fono:"
                        type="tel"
                        name="phone"
                        value={profileData.phone || ''}
                        onChange={handleChange}
                    />
                    <Input
                        label="Correo:"
                        type="email"
                        name="email"
                        value={profileData.email || ''}
                        onChange={handleChange}
                        required
                    />
                </div>

                <div className="input-row">
                    <Input
                        label="Puesto de trabajo:"
                        name="jobTitle"
                        value={profileData.jobTitle || ''}
                        onChange={handleChange}
                    />
                    <div className="input-group">
                        <label>ContraseÃ±a:</label>
                        <input
                            type={showPassword ? 'text' : 'password'}
                            name="password"
                            value="********" // No se puede modificar
                            disabled
                        />
                        <Button type="button" onClick={() => setShowPassword(!showPassword)}>
                            {showPassword ? 'Ocultar' : 'Mostrar'}
                        </Button>
                    </div>
                </div>
                <Button type="submit" className="save-button">Guardar cambios</Button>
            </form>
        </div>
    );
};

export default EditProfilePage;
'''

### features/employees/pages/PayrollSelfServicePage.jsx
'''
import React from 'react';
import { useNavigate } from 'react-router-dom'; // Importamos useNavigate
import { Briefcase, FileText, Download, ArrowLeft } from 'lucide-react';
import PaystubDownloadWidget from '@components/PaystubDownloadWidget.jsx';
import '@styles_e/PayrollSelfServicePage.css';

// Datos fijos de simulaciÃ³n para la demostraciÃ³n
const mockPaystubs = [
    { id: 1, period: 'Agosto 2025', amount: 3500.00 },
    { id: 2, period: 'Julio 2025', amount: 3500.00 },
    { id: 3, period: 'Junio 2025', amount: 3500.00 },
];

/**
 * PÃ¡gina del empleado para gestionar informaciÃ³n de nÃ³mina y descargar boletas.
 */
const PayrollSelfServicePage = () => {
    const navigate = useNavigate(); // Inicializamos el hook de navegaciÃ³n

    return (
        <div className="payroll-page">
            <div className="payroll-container">
                {/* BotÃ³n para volver al dashboard */}
                <button
                    onClick={() => navigate('/dashboard')}
                    className="back-button"
                >
                    <ArrowLeft className="back-icon" /> Volver al Dashboard
                </button>

                <h1 className="payroll-title">Portal de Autoservicio de NÃ³mina</h1>
                <p className="payroll-subtitle">
                    Consulta tu informaciÃ³n de pagos y descarga tus boletas electrÃ³nicas de forma segura.
                </p>

                <div className="payroll-content">
                    {/* El widget ahora tendrÃ¡ un botÃ³n mÃ¡s estÃ©tico */}
                    <PaystubDownloadWidget paystubs={mockPaystubs} />

                    {/* SecciÃ³n de datos fijos */}
                    <div className="affiliation-card">
                        <h3 className="affiliation-title">
                            <Briefcase className="icon briefcase" /> Datos de AfiliaciÃ³n (Solo Lectura)
                        </h3>
                        <p>
                            RÃ©gimen Laboral: <span className="data-highlight">RÃ©gimen General</span>
                        </p>
                        <p>
                            Sistema de Pensiones: <span className="data-highlight">AFP Integra (CUSPP: 12345678)</span>
                        </p>
                        <p>
                            Cuenta Bancaria CTS: <span className="data-highlight">BCP Soles (Cta: XXXX-XXXX-1234)</span>
                        </p>
                        <p className="info-text">
                            Para actualizar estos datos, por favor contacta al Ã¡rea de RRHH.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default PayrollSelfServicePage;
'''

### features/payroll/api/attendances.js
'''
// API para gestiÃ³n de asistencias y novedades
const API_BASE_URL = 'http://localhost:8081/api';

const getToken = () => localStorage.getItem('token');

const getHeaders = () => ({
  'Content-Type': 'application/json',
  'Authorization': `Bearer ${getToken()}`
});

// Listar asistencias con filtros opcionales
export const getAllAttendances = async (periodo = null, empleadoId = null) => {
  try {
    let url = `${API_BASE_URL}/asistencias`;
    const params = new URLSearchParams();
    
    if (periodo) params.append('periodo', periodo);
    if (empleadoId) params.append('empleadoId', empleadoId);
    
    if (params.toString()) url += `?${params.toString()}`;
    
    const response = await fetch(url, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener asistencias');
    return await response.json();
  } catch (error) {
    console.error('Error en getAllAttendances:', error);
    throw error;
  }
};

// Obtener resumen de asistencias por empleado y periodo
export const getAttendanceSummary = async (empleadoId, periodo) => {
  try {
    const response = await fetch(
      `${API_BASE_URL}/asistencias/resumen?empleadoId=${empleadoId}&periodo=${periodo}`,
      {
        method: 'GET',
        headers: getHeaders()
      }
    );
    
    if (!response.ok) throw new Error('Error al obtener resumen de asistencias');
    return await response.json();
  } catch (error) {
    console.error('Error en getAttendanceSummary:', error);
    throw error;
  }
};

// Registrar asistencia/novedad
export const createAttendance = async (asistenciaData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/asistencias`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(asistenciaData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al registrar asistencia');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en createAttendance:', error);
    throw error;
  }
};

// Actualizar asistencia
export const updateAttendance = async (id, asistenciaData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/asistencias/${id}`, {
      method: 'PUT',
      headers: getHeaders(),
      body: JSON.stringify(asistenciaData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al actualizar asistencia');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en updateAttendance:', error);
    throw error;
  }
};

// Eliminar asistencia
export const deleteAttendance = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/asistencias/${id}`, {
      method: 'DELETE',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al eliminar asistencia');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en deleteAttendance:', error);
    throw error;
  }
};

'''

### features/payroll/api/employees.js
'''
// API para gestiÃ³n de empleados
const API_BASE_URL = 'http://localhost:8081/api';

// Obtener token del localStorage
const getToken = () => localStorage.getItem('token');

// Headers con autenticaciÃ³n
const getHeaders = () => ({
  'Content-Type': 'application/json',
  'Authorization': `Bearer ${getToken()}`
});

// Listar todos los empleados
export const getAllEmployees = async (estado = null) => {
  try {
    const url = estado 
      ? `${API_BASE_URL}/empleados?estado=${estado}`
      : `${API_BASE_URL}/empleados`;
    
    const response = await fetch(url, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener empleados');
    return await response.json();
  } catch (error) {
    console.error('Error en getAllEmployees:', error);
    throw error;
  }
};

// Obtener empleado por ID
export const getEmployeeById = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/empleados/${id}`, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener empleado');
    return await response.json();
  } catch (error) {
    console.error('Error en getEmployeeById:', error);
    throw error;
  }
};

// Crear nuevo empleado
export const createEmployee = async (empleadoData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/empleados`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(empleadoData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al crear empleado');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en createEmployee:', error);
    throw error;
  }
};

// Actualizar empleado
export const updateEmployee = async (id, empleadoData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/empleados/${id}`, {
      method: 'PUT',
      headers: getHeaders(),
      body: JSON.stringify(empleadoData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al actualizar empleado');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en updateEmployee:', error);
    throw error;
  }
};

// Cambiar estado del empleado
export const changeEmployeeStatus = async (id, nuevoEstado) => {
  try {
    const response = await fetch(`${API_BASE_URL}/empleados/${id}/estado`, {
      method: 'PATCH',
      headers: getHeaders(),
      body: JSON.stringify({ estado: nuevoEstado })
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al cambiar estado');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en changeEmployeeStatus:', error);
    throw error;
  }
};

// Eliminar empleado
export const deleteEmployee = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/empleados/${id}`, {
      method: 'DELETE',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json().catch(() => ({ error: 'Error al eliminar empleado' }));
      throw new Error(errorData.error || 'Error al eliminar empleado');
    }
    
    // DELETE puede no retornar JSON, solo verificamos que fue exitoso
    const text = await response.text();
    return text ? JSON.parse(text) : { message: 'Empleado eliminado correctamente' };
  } catch (error) {
    console.error('Error en deleteEmployee:', error);
    throw error;
  }
};

'''

### features/payroll/api/payroll.js
'''
// API para gestiÃ³n de planillas
const API_BASE_URL = 'http://localhost:8081/api';

const getToken = () => localStorage.getItem('token');

const getHeaders = () => ({
  'Content-Type': 'application/json',
  'Authorization': `Bearer ${getToken()}`
});

// Listar todas las planillas
export const getAllPayrolls = async () => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas`, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener planillas');
    return await response.json();
  } catch (error) {
    console.error('Error en getAllPayrolls:', error);
    throw error;
  }
};

// Obtener planilla por ID
export const getPayrollById = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${id}`, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener planilla');
    return await response.json();
  } catch (error) {
    console.error('Error en getPayrollById:', error);
    throw error;
  }
};

// Obtener planilla por periodo
export const getPayrollByPeriod = async (periodo) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/periodo/${periodo}`, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener planilla del periodo');
    return await response.json();
  } catch (error) {
    console.error('Error en getPayrollByPeriod:', error);
    throw error;
  }
};

// Crear nueva planilla
export const createPayroll = async (planillaData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(planillaData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al crear planilla');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en createPayroll:', error);
    throw error;
  }
};

// Actualizar planilla existente
export const updatePayroll = async (id, planillaData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${id}`, {
      method: 'PUT',
      headers: getHeaders(),
      body: JSON.stringify(planillaData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al actualizar planilla');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en updatePayroll:', error);
    throw error;
  }
};

// Calcular remuneraciones de una planilla
export const calculatePayroll = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${id}/calcular`, {
      method: 'POST',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al calcular planilla');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en calculatePayroll:', error);
    throw error;
  }
};

// Aprobar planilla
export const approvePayroll = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${id}/aprobar`, {
      method: 'PUT',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al aprobar planilla');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en approvePayroll:', error);
    throw error;
  }
};

// Vincular pago a planilla
export const linkPaymentToPayroll = async (planillaId, pagoId) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${planillaId}/vincular-pago`, {
      method: 'PUT',
      headers: getHeaders(),
      body: JSON.stringify({ pagoId })
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al vincular pago');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en linkPaymentToPayroll:', error);
    throw error;
  }
};

// Eliminar planilla
export const deletePayroll = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/planillas/${id}`, {
      method: 'DELETE',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al eliminar planilla');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en deletePayroll:', error);
    throw error;
  }
};

'''

### features/payroll/api/payslips.js
'''
// API para gestiÃ³n de boletas de pago
const API_BASE_URL = 'http://localhost:8081/api';

const getToken = () => localStorage.getItem('token');

const getHeaders = () => ({
  'Content-Type': 'application/json',
  'Authorization': `Bearer ${getToken()}`
});

// Listar boletas con filtros opcionales
export const getAllPayslips = async (pagoId = null, empleadoId = null) => {
  try {
    let url = `${API_BASE_URL}/boletas`;
    const params = new URLSearchParams();
    
    if (pagoId) params.append('pagoId', pagoId);
    if (empleadoId) params.append('empleadoId', empleadoId);
    
    if (params.toString()) url += `?${params.toString()}`;
    
    const response = await fetch(url, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener boletas');
    return await response.json();
  } catch (error) {
    console.error('Error en getAllPayslips:', error);
    throw error;
  }
};

// Obtener boleta por ID
export const getPayslipById = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/boletas/${id}`, {
      method: 'GET',
      headers: getHeaders()
    });
    
    if (!response.ok) throw new Error('Error al obtener boleta');
    return await response.json();
  } catch (error) {
    console.error('Error en getPayslipById:', error);
    throw error;
  }
};

// Generar boletas para una planilla completa
export const generatePayslipsForPayroll = async (planillaId) => {
  try {
    const response = await fetch(`${API_BASE_URL}/boletas/generar/${planillaId}`, {
      method: 'POST',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al generar boletas');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en generatePayslipsForPayroll:', error);
    throw error;
  }
};

// Crear boleta manual
export const createPayslip = async (boletaData) => {
  try {
    const response = await fetch(`${API_BASE_URL}/boletas`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(boletaData)
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al crear boleta');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en createPayslip:', error);
    throw error;
  }
};

// Eliminar boleta
export const deletePayslip = async (id) => {
  try {
    const response = await fetch(`${API_BASE_URL}/boletas/${id}`, {
      method: 'DELETE',
      headers: getHeaders()
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Error al eliminar boleta');
    }
    return await response.json();
  } catch (error) {
    console.error('Error en deletePayslip:', error);
    throw error;
  }
};

'''

### features/payroll/components/common/ConceptAffectationForm.jsx
'''

'''

### features/payroll/components/common/ConceptAffectionsFrom.jsx
'''

'''

### features/payroll/components/common/DataSummaryCard.jsx
'''

'''

### features/payroll/components/common/PayrollCalendar.jsx
'''

'''

### features/payroll/components/masters/EmployeePayrollDetails.jsx
'''
// src/features/payroll/pages/EmployeePayrollDetailsPage.jsx
import React from 'react';
import { Link } from 'react-router-dom';
import Sidebar from '@ui/Sidebar.jsx'; // AsegÃºrate de que la ruta sea correcta
import Navbar from '@ui/Navbar.jsx'; // AsegÃºrate de que la ruta sea correcta
import '@styles_e/DashboardPage.css'; // O el archivo CSS que uses para el layout

const EmployeePayrollDetailsPage = ({ user, onLogout }) => {
  return (
    <div className="dashboard-layout">
      <Sidebar />
      <div className="main-content">
        <Navbar user={user} onLogout={onLogout} />
        <div className="dashboard-content p-8">
          <h1 className="text-3xl font-extrabold text-gray-900">Detalles de NÃ³mina por Empleado</h1>
          <p className="text-gray-600 mt-2">Busca un empleado para editar su RÃ©gimen Laboral, CUSPP, Cuenta Bancaria, etc.</p>
          
          <div className="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-500 mt-6">
            <h3 className="text-xl font-semibold mb-4 text-gray-800">Editar Datos de NÃ³mina del Empleado</h3>
            <input 
              type="text" 
              placeholder="Buscar Empleado por DNI/CÃ³digo" 
              className="w-full mt-2 p-3 border border-gray-300 rounded-lg focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50" 
            />
            <button className="mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium">
              Cargar Detalles del Empleado
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default EmployeePayrollDetailsPage;
'''

### features/payroll/components/masters/LegalParametersTable.jsx
'''
// src/features/payroll/pages/LegalParametersPage.jsx
import React from 'react';
import { Link } from 'react-router-dom';
import Sidebar from '@ui/Sidebar.jsx'; // AsegÃºrate de que la ruta sea correcta
import Navbar from '@ui/Navbar.jsx'; // AsegÃºrate de que la ruta sea correcta
import { Coins, Settings } from 'lucide-react'; // SimulaciÃ³n de iconos, asegÃºrate de tener lucide-react instalado

const LegalParametersPage = ({ legal, centers, user, onLogout }) => {
  // SimulaciÃ³n de datos si no los pasas por props
  const defaultLegal = { uit: 5150.00, rmv: 1025.00 };
  const finalLegal = legal || defaultLegal;

  return (
    <div className="dashboard-layout">
      <Sidebar />
      <div className="main-content">
        <Navbar user={user} onLogout={onLogout} />
        <div className="dashboard-content p-8">
          <h1 className="text-3xl font-extrabold text-gray-900">Maestros y ConfiguraciÃ³n</h1>
          <div className="grid grid-cols-1 gap-8 mt-6">
            
            {/* ParÃ¡metros Legales */}
            <div className="bg-white p-6 rounded-xl shadow-lg border-l-4 border-indigo-500">
              <h3 className="text-xl font-semibold mb-4 text-gray-800 flex items-center">
                <Coins className="w-5 h-5 mr-2 text-indigo-600" /> ParÃ¡metros Legales (UIT y RMV)
              </h3>
              <p className="text-gray-600">UIT actual: <span className="font-bold text-indigo-600">S/ {finalLegal.uit.toFixed(2)}</span></p>
              <p className="text-gray-600">RMV actual: <span className="font-bold text-indigo-600">S/ {finalLegal.rmv.toFixed(2)}</span></p>
              <button className="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">
                Gestionar HistÃ³rico / AFP Config
              </button>
            </div>

            {/* GestiÃ³n de Conceptos y AfectaciÃ³n */}
            <div className="bg-white p-6 rounded-xl shadow-lg border-l-4 border-yellow-500">
              <h3 className="text-xl font-semibold mb-4 text-gray-800 flex items-center">
                <Settings className="w-5 h-5 mr-2 text-yellow-600" /> GestiÃ³n de Conceptos y AfectaciÃ³n
              </h3>
              <p className="text-gray-600">Define si los haberes y descuentos estÃ¡n afectos a Renta de 5ta, ESSALUD, o Aportes.</p>
              <button className="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">
                Editar Conceptos
              </button>
            </div>

            {/* No se incluye CostCenterTable ya que la instrucciÃ³n fue eliminar "costos" de la pÃ¡gina */}
            {/* Puedes agregarla aquÃ­ si lo necesitas */}
          </div>
        </div>
      </div>
    </div>
  );
};

export default LegalParametersPage;
'''

### features/payroll/components/outputs/BankExportButton.jsx
'''

'''

### features/payroll/components/outputs/PaystubUploader.jsx
'''

'''

### features/payroll/components/outputs/PlameExportButton.jsx
'''

'''

### features/payroll/components/processes/MonthlyNoveltyEntry.jsx
'''
import React, { useState, useEffect } from 'react';
import { getAllEmployees } from '../../api/employees';
import { createAttendance, getAllAttendances } from '../../api/attendances';
import '../../styles/MonthlyNoveltyEntry.css';

const MonthlyNoveltyEntry = () => {
  const [employees, setEmployees] = useState([]);
  const [selectedEmployee, setSelectedEmployee] = useState('');
  const [periodo, setPeriodo] = useState('');
  const [novelties, setNovelties] = useState([]);
  const [formData, setFormData] = useState({
    empleadoId: '',
    periodo: '',
    tipoNovedad: 'HORAS_EXTRAS',
    cantidad: '',
    monto: '',
    descripcion: ''
  });
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    // Establecer periodo actual (YYYY-MM)
    const now = new Date();
    const currentPeriod = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    setPeriodo(currentPeriod);
    setFormData(prev => ({ ...prev, periodo: currentPeriod }));
    
    loadEmployees();
  }, []);

  useEffect(() => {
    if (selectedEmployee && periodo) {
      loadNovelties();
    }
  }, [selectedEmployee, periodo]);

  const loadEmployees = async () => {
    try {
      const data = await getAllEmployees('ACTIVO');
      console.log('Empleados cargados:', data);
      setEmployees(data);
    } catch (error) {
      console.error('Error loading employees:', error);
    }
  };

  const loadNovelties = async () => {
    try {
      if (!selectedEmployee) return;
      const employeeId = parseInt(selectedEmployee);
      const data = await getAllAttendances(periodo, employeeId);
      setNovelties(data);
    } catch (error) {
      console.error('Error loading novelties:', error);
      setNovelties([]);
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
    
    if (name === 'empleadoId') {
      setSelectedEmployee(value);
    }
    
    // Actualizar el estado periodo cuando cambia el selector
    if (name === 'periodo') {
      setPeriodo(value);
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!formData.empleadoId) {
      alert('Por favor seleccione un empleado');
      return;
    }
    
    try {
      setLoading(true);
      
      // Adaptar los datos al modelo de Asistencias del backend
      const cantidad = parseFloat(formData.cantidad) || 0;
      
      // CORREGIDO: Usar el periodo seleccionado para construir la fecha
      // Formato periodo: "2025-09" -> convertir a fecha del mes: "2025-09-15"
      const [year, month] = periodo.split('-');
      const fechaDelPeriodo = `${year}-${month}-15`; // Usar dÃ­a 15 del mes seleccionado
      
      const dataToSend = {
        empleadoId: parseInt(formData.empleadoId),
        fecha: fechaDelPeriodo, // Usar fecha del periodo seleccionado
        horasTrabajadas: formData.tipoNovedad === 'HORAS_EXTRAS' ? 0 : cantidad,
        horasExtra: formData.tipoNovedad === 'HORAS_EXTRAS' ? cantidad : 0,
        tardanza: formData.tipoNovedad === 'TARDANZA' ? cantidad : 0,
        ausencia: formData.tipoNovedad === 'FALTA'
      };

      console.log('ğŸ“… Periodo seleccionado:', periodo);
      console.log('ğŸ“… Fecha generada:', fechaDelPeriodo);
      console.log('ğŸ“¤ Datos a enviar:', dataToSend);

      await createAttendance(dataToSend);
      alert('Novedad registrada exitosamente para el periodo ' + periodo);
      
      // Resetear formulario parcialmente
      setFormData(prev => ({
        ...prev,
        cantidad: '',
        monto: '',
        descripcion: ''
      }));
      
      // Recargar novedades
      loadNovelties();
    } catch (error) {
      alert('Error al registrar novedad: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="monthly-novelty-entry">
      <h1>Ingreso de Novedades Mensuales</h1>
      <p className="subtitle">Registrar horas extras, faltas, adelantos y bonificaciones</p>

      {/* Instrucciones */}
      <div className="instructions-box">
        <h3>ğŸ“‹ Â¿CÃ³mo funciona esta pÃ¡gina?</h3>
        <div className="instructions-content">
          <div className="instruction-item">
            <span className="step-number">1</span>
            <div>
              <strong>Seleccione el Periodo y Empleado</strong>
              <p>Elija el mes y el empleado para el cual registrarÃ¡ novedades.</p>
            </div>
          </div>
          <div className="instruction-item">
            <span className="step-number">2</span>
            <div>
              <strong>Registre la Novedad</strong>
              <p>Indique el tipo (horas extras, tardanza, falta) y la cantidad correspondiente.</p>
            </div>
          </div>
          <div className="instruction-item">
            <span className="step-number">3</span>
            <div>
              <strong>Guarde el Registro</strong>
              <p>Las novedades se registran en el sistema de asistencias y pueden afectar el cÃ¡lculo de la planilla.</p>
            </div>
          </div>
        </div>
        <div className="info-note">
          <strong>â„¹ï¸ Nota:</strong> Las novedades registradas aquÃ­ se vincularÃ¡n con el sistema de asistencias. 
          Actualmente el mÃ³dulo registra horas extras, tardanzas y ausencias que pueden ser consultadas posteriormente.
        </div>
      </div>

      <div className="novelty-form-container">
        <form onSubmit={handleSubmit} className="novelty-form">
          <div className="form-row">
            <div className="form-group">
              <label>Periodo *</label>
              <input
                type="month"
                name="periodo"
                value={formData.periodo}
                onChange={handleChange}
                required
              />
            </div>

            <div className="form-group">
              <label>Empleado *</label>
              <select
                name="empleadoId"
                value={formData.empleadoId}
                onChange={handleChange}
                required
              >
                <option value="">Seleccione un empleado</option>
                {employees.map(emp => (
                  <option key={emp.id} value={emp.id}>
                    {emp.nombre} - DNI: {emp.dni}
                  </option>
                ))}
              </select>
            </div>
          </div>

          <div className="form-row">
            <div className="form-group">
              <label>Tipo de Novedad *</label>
              <select
                name="tipoNovedad"
                value={formData.tipoNovedad}
                onChange={handleChange}
                required
              >
                <option key="horas" value="HORAS_EXTRAS">Horas Extras</option>
                <option key="falta" value="FALTA">Falta</option>
                <option key="tardanza" value="TARDANZA">Tardanza</option>
                <option key="adelanto" value="ADELANTO">Adelanto de Sueldo</option>
                <option key="bonificacion" value="BONIFICACION">BonificaciÃ³n</option>
                <option key="descuento" value="DESCUENTO">Descuento</option>
              </select>
            </div>

            <div className="form-group">
              <label>Cantidad</label>
              <input
                type="number"
                step="0.01"
                name="cantidad"
                value={formData.cantidad}
                onChange={handleChange}
                placeholder="Horas, dÃ­as, etc."
              />
            </div>

            <div className="form-group">
              <label>Monto (S/)</label>
              <input
                type="number"
                step="0.01"
                name="monto"
                value={formData.monto}
                onChange={handleChange}
                placeholder="0.00"
              />
            </div>
          </div>

          <div className="form-group">
            <label>DescripciÃ³n</label>
            <textarea
              name="descripcion"
              value={formData.descripcion}
              onChange={handleChange}
              rows="3"
              placeholder="Detalle adicional sobre la novedad..."
            />
          </div>

          <button type="submit" className="btn btn-primary" disabled={loading}>
            {loading ? 'Guardando...' : 'ğŸ’¾ Registrar Novedad'}
          </button>
        </form>

        {selectedEmployee && (
          <div className="novelties-list">
            <h3>Novedades Registradas - {periodo}</h3>
            {novelties.length === 0 ? (
              <p className="no-data">No hay novedades registradas para este empleado en el periodo seleccionado</p>
            ) : (
              <table className="novelties-table">
                <thead>
                  <tr>
                    <th>Fecha</th>
                    <th>Horas Trabajadas</th>
                    <th>Horas Extra</th>
                    <th>Tardanza</th>
                    <th>Ausencia</th>
                  </tr>
                </thead>
                <tbody>
                  {novelties.map((nov, index) => (
                    <tr key={index}>
                      <td>{nov.fecha || '-'}</td>
                      <td>{nov.horasTrabajadas || 0}</td>
                      <td>{nov.horasExtra || 0}</td>
                      <td>{nov.tardanza || 0}</td>
                      <td>{nov.ausencia ? 'SÃ­' : 'No'}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            )}
          </div>
        )}
      </div>
    </div>
  );
};

export default MonthlyNoveltyEntry;
'''

### features/payroll/components/processes/PrePayrollReviewTable.jsx
'''
import React, { useState, useEffect } from 'react';
import { getAllPayrolls, calculatePayroll, approvePayroll, getPayrollById } from '../../api/payroll';
import '../../styles/PrePayrollReview.css';

const PrePayrollReviewPage = () => {
    const [payrolls, setPayrolls] = useState([]);
    const [selectedPayroll, setSelectedPayroll] = useState(null);
    const [loading, setLoading] = useState(true);

    useEffect(() => {
        loadPayrolls();
    }, []);

    const loadPayrolls = async () => {
        try {
            const data = await getAllPayrolls();
            console.log('ğŸ“‹ Todas las planillas:', data);
            const draftPayrolls = data.filter(p => p.estado === 'BORRADOR' || p.estado === 'CALCULADO');
            console.log('ğŸ“‹ Planillas filtradas (BORRADOR/CALCULADO):', draftPayrolls);
            setPayrolls(draftPayrolls);
        } catch (error) {
            console.error('Error loading payrolls:', error);
        } finally {
            setLoading(false);
        }
    };

    const handleCalculate = async (id) => {
        if (!window.confirm('Â¿Iniciar cÃ¡lculo de nÃ³mina?')) return;
        
        try {
            console.log('ğŸ§® Iniciando cÃ¡lculo para planilla ID:', id);
            const result = await calculatePayroll(id);
            console.log('âœ… Resultado del cÃ¡lculo:', result);
            alert('CÃ¡lculo finalizado correctamente');
            await loadPayrolls();
            // Cargar la planilla actualizada con sus remuneraciones
            const { getPayrollById } = await import('../../api/payroll');
            const updatedPayroll = await getPayrollById(id);
            console.log('ğŸ”„ Planilla actualizada despuÃ©s del cÃ¡lculo:', updatedPayroll);
            setSelectedPayroll(updatedPayroll);
        } catch (error) {
            console.error('âŒ Error al calcular:', error);
            alert('Error al calcular: ' + error.message);
        }
    };

    const handleApprove = async (id) => {
        if (!window.confirm('Â¿Aprobar y postear planilla?')) return;
        
        try {
            await approvePayroll(id);
            alert('Planilla aprobada correctamente');
            loadPayrolls();
            setSelectedPayroll(null);
        } catch (error) {
            alert('Error al aprobar: ' + error.message);
        }
    };

    if (loading) return <div className="loading">Cargando planillas...</div>;

    return (
        <div className="pre-payroll-review">
            <h1>RevisiÃ³n de Pre-NÃ³mina</h1>
            <p className="subtitle">Selecciona una planilla, calcula y revisa antes de aprobar</p>
            
            {/* Instrucciones y FÃ³rmulas */}
            <div className="instructions-panel">
                <h3>ğŸ§® Proceso de CÃ¡lculo y AprobaciÃ³n</h3>
                <div className="process-steps">
                    <div className="process-step">
                        <div className="step-badge borrador">BORRADOR</div>
                        <div className="step-content">
                            <h4>1. Seleccionar Planilla en Borrador</h4>
                            <p>Elija la planilla que desea calcular. Solo planillas en estado BORRADOR pueden ser calculadas.</p>
                        </div>
                    </div>
                    <div className="step-arrow">â†’</div>
                    <div className="process-step">
                        <div className="step-badge calculado">CALCULADO</div>
                        <div className="step-content">
                            <h4>2. Calcular Remuneraciones</h4>
                            <p>El sistema aplica las fÃ³rmulas a cada empleado ACTIVO:</p>
                            <ul className="formula-list">
                                <li><strong>Sueldo Bruto:</strong> Sueldo base del empleado</li>
                                <li><strong>Descuentos (13%):</strong> AFP/ONP del empleado</li>
                                <li><strong>Aportes (9%):</strong> EsSalud (asumido por empleador)</li>
                                <li><strong>Sueldo Neto:</strong> Bruto - Descuentos</li>
                            </ul>
                        </div>
                    </div>
                    <div className="step-arrow">â†’</div>
                    <div className="process-step">
                        <div className="step-badge aprobado">APROBADO</div>
                        <div className="step-content">
                            <h4>3. Revisar y Aprobar</h4>
                            <p>Revise los totales y la lista de empleados. Al aprobar, la planilla queda BLOQUEADA y lista para generar archivos.</p>
                        </div>
                    </div>
                </div>

                <div className="calculation-info">
                    <h4>ğŸ“Š InformaciÃ³n del CÃ¡lculo</h4>
                    <div className="calc-details">
                        <div className="calc-item">
                            <span className="calc-icon">ğŸ‘¥</span>
                            <div>
                                <strong>Empleados Incluidos</strong>
                                <p>Solo empleados con estado = ACTIVO</p>
                            </div>
                        </div>
                        <div className="calc-item">
                            <span className="calc-icon">ğŸ’°</span>
                            <div>
                                <strong>Total Bruto</strong>
                                <p>Suma de todos los sueldos brutos</p>
                            </div>
                        </div>
                        <div className="calc-item">
                            <span className="calc-icon">ğŸ“‰</span>
                            <div>
                                <strong>Total Descuentos</strong>
                                <p>13% de cada sueldo bruto (AFP/ONP)</p>
                            </div>
                        </div>
                        <div className="calc-item">
                            <span className="calc-icon">âœ…</span>
                            <div>
                                <strong>Total Neto</strong>
                                <p>Monto total a pagar a empleados</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            {/* Lista de planillas pendientes */}
            <div className="payroll-selector">
                <h3>Planillas Pendientes de CÃ¡lculo</h3>
                {payrolls.length === 0 ? (
                    <p className="no-data">No hay planillas en borrador o calculadas</p>
                ) : (
                    <div className="payroll-cards">
                        {payrolls.map(payroll => (
                            <div 
                                key={payroll.id}
                                className={`payroll-card ${selectedPayroll?.id === payroll.id ? 'selected' : ''}`}
                                onClick={async () => {
                                    // Si la planilla estÃ¡ calculada, cargar el detalle completo con remuneraciones
                                    if (payroll.estado === 'CALCULADO') {
                                        try {
                                            const fullPayroll = await getPayrollById(payroll.id);
                                            setSelectedPayroll(fullPayroll);
                                        } catch (error) {
                                            console.error('Error al cargar detalle:', error);
                                            setSelectedPayroll(payroll);
                                        }
                                    } else {
                                        setSelectedPayroll(payroll);
                                    }
                                }}
                            >
                                <div className="card-header">
                                    <span className="periodo">{payroll.periodo}</span>
                                    <span className={`badge badge-${payroll.estado.toLowerCase()}`}>
                                        {payroll.estado}
                                    </span>
                                </div>
                                <p className="info">Empleados: {payroll.remuneraciones?.length || 0}</p>
                                {payroll.totalNeto > 0 && (
                                    <p className="total">Total: S/ {payroll.totalNeto.toFixed(2)}</p>
                                )}
                            </div>
                        ))}
                    </div>
                )}
            </div>

            {/* Acciones de cÃ¡lculo y aprobaciÃ³n */}
            {selectedPayroll && (
                <div className="calculation-section">
                    <h3>Acciones para Planilla {selectedPayroll.periodo}</h3>
                    
                    <div className="action-buttons">
                        {selectedPayroll.estado === 'BORRADOR' && (
                            <button
                                onClick={() => handleCalculate(selectedPayroll.id)}
                                className="btn btn-calculate"
                            >
                                ğŸ§® Ejecutar CÃ¡lculo
                            </button>
                        )}
                        
                        {selectedPayroll.estado === 'CALCULADO' && (
                            <>
                                <div className="calc-success">
                                    <p>âœ“ Planilla calculada exitosamente</p>
                                    <p className="total-display">
                                        Total Bruto: S/ {selectedPayroll.totalBruto?.toFixed(2) || '0.00'} | 
                                        Total Neto: S/ {selectedPayroll.totalNeto?.toFixed(2) || '0.00'}
                                    </p>
                                </div>

                                {/* Tabla de empleados incluidos */}
                                {selectedPayroll.remuneraciones && selectedPayroll.remuneraciones.length > 0 && (
                                    <div className="employee-list">
                                        <h4>Empleados incluidos en la planilla ({selectedPayroll.remuneraciones.length})</h4>
                                        <table className="remuneraciones-table">
                                            <thead>
                                                <tr>
                                                    <th>Empleado</th>
                                                    <th>DNI</th>
                                                    <th>Puesto</th>
                                                    <th>Novedades</th>
                                                    <th>Sueldo Bruto</th>
                                                    <th>Descuentos</th>
                                                    <th>Aportes Empleador</th>
                                                    <th>Sueldo Neto</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {selectedPayroll.remuneraciones.map((rem, idx) => {
                                                    const novedades = rem.novedades || [];
                                                    const hasNovedades = novedades.length > 0;
                                                    
                                                    return (
                                                        <tr key={idx}>
                                                            <td>{rem.empleadoNombre || 'N/A'}</td>
                                                            <td>{rem.empleadoDni || 'N/A'}</td>
                                                            <td>{rem.empleadoPuesto || 'N/A'}</td>
                                                            <td className="novedades-cell">
                                                                {hasNovedades ? (
                                                                    <div className="novedades-list">
                                                                        {novedades.map((nov, nIdx) => (
                                                                            <div key={nIdx} className={`novedad-item ${nov.tipo?.toLowerCase()}`}>
                                                                                <span className="novedad-concepto">{nov.concepto}</span>
                                                                                <span className="novedad-monto">
                                                                                    {nov.tipo === 'DESCUENTO' ? '-' : '+'}S/ {nov.monto?.toFixed(2)}
                                                                                </span>
                                                                            </div>
                                                                        ))}
                                                                    </div>
                                                                ) : (
                                                                    <span className="no-novedades">Sin novedades</span>
                                                                )}
                                                            </td>
                                                            <td>S/ {rem.sueldoBruto?.toFixed(2)}</td>
                                                            <td>S/ {rem.descuentos?.toFixed(2)}</td>
                                                            <td>S/ {rem.aportes?.toFixed(2)}</td>
                                                            <td><strong>S/ {rem.sueldoNeto?.toFixed(2)}</strong></td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                )}

                                <button
                                    onClick={() => handleApprove(selectedPayroll.id)}
                                    className="btn btn-approve"
                                >
                                    âœ“ Aprobar Planilla
                                </button>
                            </>
                        )}
                    </div>
                </div>
            )}
        </div>
    );
};

export default PrePayrollReviewPage;
'''

### features/payroll/components/reports/OutputFilesPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { getAllPayrolls } from '../../api/payroll';
import { generatePayslipsForPayroll } from '../../api/payslips';
import '../../styles/OutputFiles.css';

const OutputFilesPage = () => {
    const [payrolls, setPayrolls] = useState([]);
    const [selectedPayroll, setSelectedPayroll] = useState('');
    const [loading, setLoading] = useState(true);
    const [generating, setGenerating] = useState(false);

    useEffect(() => {
        loadPayrolls();
    }, []);

    const loadPayrolls = async () => {
        try {
            const data = await getAllPayrolls();
            console.log('ğŸ“ [Archivos] Todas las planillas:', data);
            const approved = data.filter(p => 
                p.estado === 'APROBADO' || p.estado === 'APROBADA' || 
                p.estado === 'CALCULADO' || p.estado === 'CALCULADA'
            );
            console.log('ğŸ“ [Archivos] Planillas aprobadas/calculadas:', approved);
            setPayrolls(approved);
        } catch (error) {
            console.error('Error loading payrolls:', error);
        } finally {
            setLoading(false);
        }
    };

    const downloadFile = async (url, filename) => {
        try {
            const token = localStorage.getItem('token');
            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });

            if (!response.ok) {
                throw new Error('Error al descargar el archivo');
            }

            const blob = await response.blob();
            const downloadUrl = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = downloadUrl;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            link.remove();
            window.URL.revokeObjectURL(downloadUrl);
        } catch (error) {
            console.error('Error downloading file:', error);
            throw error;
        }
    };

    const handleExportPLAME = async () => {
        if (!selectedPayroll) {
            alert('Por favor seleccione una planilla');
            return;
        }

        try {
            setGenerating(true);
            const planilla = payrolls.find(p => p.id === parseInt(selectedPayroll));
            const filename = `PLAME_${planilla.periodo}.txt`;
            await downloadFile(`http://localhost:8081/api/planillas/${selectedPayroll}/exportar/plame`, filename);
            alert('Archivo PLAME descargado correctamente');
        } catch (error) {
            alert('Error al exportar PLAME: ' + error.message);
        } finally {
            setGenerating(false);
        }
    };

    const handleExportBank = async () => {
        if (!selectedPayroll) {
            alert('Por favor seleccione una planilla');
            return;
        }

        try {
            setGenerating(true);
            const planilla = payrolls.find(p => p.id === parseInt(selectedPayroll));
            const filename = `BANCO_${planilla.periodo}.csv`;
            await downloadFile(`http://localhost:8081/api/planillas/${selectedPayroll}/exportar/banco`, filename);
            alert('Archivo bancario CSV descargado correctamente');
        } catch (error) {
            alert('Error al exportar archivo bancario: ' + error.message);
        } finally {
            setGenerating(false);
        }
    };

    const handleExportBankExcel = async () => {
        if (!selectedPayroll) {
            alert('Por favor seleccione una planilla');
            return;
        }

        try {
            setGenerating(true);
            const planilla = payrolls.find(p => p.id === parseInt(selectedPayroll));
            const filename = `BANCO_${planilla.periodo}.xlsx`;
            await downloadFile(`http://localhost:8081/api/planillas/${selectedPayroll}/exportar/banco/excel`, filename);
            alert('Archivo bancario Excel descargado correctamente');
        } catch (error) {
            alert('Error al exportar archivo bancario Excel: ' + error.message);
        } finally {
            setGenerating(false);
        }
    };

    const handleGeneratePayslipsPDF = async () => {
        if (!selectedPayroll) {
            alert('Por favor seleccione una planilla');
            return;
        }

        try {
            setGenerating(true);
            // Descargar el PDF directamente desde las remuneraciones
            const planilla = payrolls.find(p => p.id === parseInt(selectedPayroll));
            const filename = `BOLETAS_${planilla.periodo}.pdf`;
            await downloadFile(`http://localhost:8081/api/planillas/${selectedPayroll}/exportar/boletas/pdf`, filename);
            alert('Boletas PDF descargadas correctamente');
        } catch (error) {
            alert('Error al generar boletas PDF: ' + error.message);
        } finally {
            setGenerating(false);
        }
    };

    if (loading) return <div className="loading">Cargando...</div>;

    return (
        <div className="output-files-page">
            <h1>GeneraciÃ³n de Archivos de Salida</h1>
            <p className="subtitle">Exporta archivos para impuestos, pagos bancarios y boletas</p>

            <div className="payroll-selector">
                <label>Seleccionar Planilla Aprobada/Calculada:</label>
                <select 
                    value={selectedPayroll} 
                    onChange={(e) => setSelectedPayroll(e.target.value)}
                >
                    <option value="">-- Seleccione una planilla --</option>
                    {payrolls.map(payroll => (
                        <option key={payroll.id} value={payroll.id}>
                            {payroll.periodo} - {payroll.estado} - {payroll.remuneraciones?.length || 0} empleados
                        </option>
                    ))}
                </select>
            </div>

            <div className="files-grid">
                <div className="file-card plame">
                    <div className="card-icon">ğŸ“„</div>
                    <h3>Archivo PLAME</h3>
                    <p>Exportar datos para SUNAT (TXT)</p>
                    <button 
                        onClick={handleExportPLAME}
                        disabled={!selectedPayroll || generating}
                        className="btn btn-plame"
                    >
                        {generating ? 'â³ Descargando...' : 'ğŸ“¥ Exportar TXT'}
                    </button>
                </div>

                <div className="file-card bank">
                    <div className="card-icon">ğŸ¦</div>
                    <h3>Archivo Bancario</h3>
                    <p>Telecredito / Pagos masivos</p>
                    <div style={{ display: 'flex', gap: '10px', flexDirection: 'column' }}>
                        <button 
                            onClick={handleExportBank}
                            disabled={!selectedPayroll || generating}
                            className="btn btn-bank"
                        >
                            {generating ? 'â³ Descargando...' : 'ğŸ“¥ Exportar CSV'}
                        </button>
                        <button 
                            onClick={handleExportBankExcel}
                            disabled={!selectedPayroll || generating}
                            className="btn btn-bank"
                        >
                            {generating ? 'â³ Descargando...' : 'ğŸ“¥ Exportar Excel'}
                        </button>
                    </div>
                </div>

                <div className="file-card payslips">
                    <div className="card-icon">ğŸ“‹</div>
                    <h3>Boletas de Pago</h3>
                    <p>Generar boletas electrÃ³nicas (PDF)</p>
                    <button 
                        onClick={handleGeneratePayslipsPDF}
                        disabled={!selectedPayroll || generating}
                        className="btn btn-payslips"
                    >
                        {generating ? 'â³ Generando...' : 'ğŸ“‹ Descargar Boletas PDF'}
                    </button>
                </div>
            </div>

            {!selectedPayroll && (
                <div className="info-message">
                    â„¹ï¸ Seleccione una planilla aprobada para habilitar las opciones de exportaciÃ³n
                </div>
            )}
        </div>
    );
};

export default OutputFilesPage;
'''

### features/payroll/components/reports/PayrollSummaryReportPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { getAllPayrolls, getPayrollByPeriod } from '../../api/payroll';
import '../../styles/PayrollSummaryReport.css';

const PayrollSummaryReportPage = () => {
    const [payrolls, setPayrolls] = useState([]);
    const [selectedPeriod, setSelectedPeriod] = useState('');
    const [summary, setSummary] = useState(null);
    const [loading, setLoading] = useState(true);

    useEffect(() => {
        loadPayrolls();
    }, []);

    const loadPayrolls = async () => {
        try {
            const data = await getAllPayrolls();
            console.log('ğŸ“Š [Resumen] Todas las planillas:', data);
            const approved = data.filter(p => 
                p.estado === 'APROBADO' || p.estado === 'APROBADA' || 
                p.estado === 'CALCULADO' || p.estado === 'CALCULADA'
            );
            console.log('ğŸ“Š [Resumen] Planillas aprobadas/calculadas:', approved);
            setPayrolls(approved);
        } catch (error) {
            console.error('Error loading payrolls:', error);
        } finally {
            setLoading(false);
        }
    };

    const loadSummary = async (periodo) => {
        try {
            const data = await getPayrollByPeriod(periodo);
            setSummary(data);
        } catch (error) {
            alert('Error al cargar resumen: ' + error.message);
        }
    };

    const handlePeriodChange = (e) => {
        const period = e.target.value;
        setSelectedPeriod(period);
        if (period) {
            loadSummary(period);
        } else {
            setSummary(null);
        }
    };

    if (loading) return <div className="loading">Cargando...</div>;

    return (
        <div className="payroll-summary-report">
            <h1>Resumen de Planilla por Periodo</h1>
            <p className="subtitle">InformaciÃ³n histÃ³rica y analÃ­tica para la toma de decisiones</p>

            <div className="period-selector">
                <label>Seleccionar Periodo:</label>
                <select value={selectedPeriod} onChange={handlePeriodChange}>
                    <option value="">-- Seleccione un periodo --</option>
                    {payrolls.map(payroll => (
                        <option key={payroll.id} value={payroll.periodo}>
                            {payroll.periodo} - {payroll.estado} - {payroll.remuneraciones?.length || 0} empleados
                        </option>
                    ))}
                </select>
            </div>

            {summary && (
                <div className="summary-content">
                    <div className="summary-cards">
                        <div className="summary-card blue">
                            <span className="card-label">Total Bruto</span>
                            <span className="card-value">S/ {summary.totalBruto?.toFixed(2) || '0.00'}</span>
                        </div>
                        <div className="summary-card green">
                            <span className="card-label">Total Neto</span>
                            <span className="card-value">S/ {summary.totalNeto?.toFixed(2) || '0.00'}</span>
                        </div>
                        <div className="summary-card orange">
                            <span className="card-label">Estado</span>
                            <span className="card-value">{summary.estado}</span>
                        </div>
                    </div>

                    <div className="summary-details">
                        <h3>Detalles de la Planilla</h3>
                        <table className="details-table">
                            <tbody>
                                <tr>
                                    <th>ID Planilla:</th>
                                    <td>{summary.id}</td>
                                </tr>
                                <tr>
                                    <th>Periodo:</th>
                                    <td>{summary.periodo}</td>
                                </tr>
                                <tr>
                                    <th>Cantidad de Empleados:</th>
                                    <td>{summary.remuneraciones?.length || 0}</td>
                                </tr>
                                <tr>
                                    <th>Estado:</th>
                                    <td><span className={`badge badge-${summary.estado?.toLowerCase()}`}>{summary.estado}</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            )}

            {!summary && selectedPeriod && (
                <div className="no-data">No se encontraron datos para el periodo seleccionado</div>
            )}
        </div>
    );
};

export default PayrollSummaryReportPage;
'''

### features/payroll/hooks/usePayrollCalculations.js
'''

'''

### features/payroll/pages/EmployeeDetailPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { getEmployeeById } from '../api/employees';
import '../styles/EmployeeDetailPage.css';

const EmployeeDetailPage = () => {
  const { id } = useParams();
  const navigate = useNavigate();
  const [employee, setEmployee] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    if (!id || id === 'undefined') {
      setError('ID de empleado no vÃ¡lido');
      setLoading(false);
      return;
    }
    loadEmployeeData();
  }, [id]);

  const loadEmployeeData = async () => {
    try {
      setLoading(true);
      const data = await getEmployeeById(id);
      setEmployee(data);
      setError(null);
    } catch (err) {
      setError('Error al cargar empleado: ' + err.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <div className="loading">Cargando empleado...</div>;
  if (error) return <div className="error-message">{error}</div>;
  if (!employee) return <div className="error-message">Empleado no encontrado</div>;

  return (
    <div className="employee-detail-page">
      <div className="page-header">
        <h1>Detalles del Empleado</h1>
        <div className="header-actions">
          <button 
            className="btn btn-secondary"
            onClick={() => navigate('/masters/employees')}
          >
            â† Volver
          </button>
          <button 
            className="btn btn-primary"
            onClick={() => navigate(`/masters/employees/${id}/edit`)}
          >
            âœï¸ Editar
          </button>
        </div>
      </div>

      <div className="employee-detail-card">
        <div className="detail-section">
          <h3>InformaciÃ³n Personal</h3>
          <div className="detail-grid">
            <div className="detail-item">
              <label>ID</label>
              <span>{employee.idEmpleado || employee.id}</span>
            </div>
            <div className="detail-item">
              <label>Nombre Completo</label>
              <span>{employee.nombre}</span>
            </div>
            <div className="detail-item">
              <label>Documento</label>
              <span>{employee.dni || 'No registrado'}</span>
            </div>
            <div className="detail-item">
              <label>Estado</label>
              <span className={`badge badge-${employee.estado?.toLowerCase()}`}>
                {employee.estado}
              </span>
            </div>
          </div>
        </div>

        <div className="detail-section">
          <h3>InformaciÃ³n Laboral</h3>
          <div className="detail-grid">
            <div className="detail-item">
              <label>Puesto/Cargo</label>
              <span>{employee.puesto || 'No especificado'}</span>
            </div>
            <div className="detail-item">
              <label>Sueldo Base</label>
              <span className="sueldo">S/ {employee.sueldoBase?.toFixed(2) || '0.00'}</span>
            </div>
            <div className="detail-item">
              <label>Fecha de Registro</label>
              <span>{employee.createdAt ? new Date(employee.createdAt).toLocaleDateString() : 'No disponible'}</span>
            </div>
          </div>
        </div>

        <div className="detail-actions">
          <button 
            className="btn btn-outline"
            onClick={() => navigate(`/masters/employees/${id}/edit`)}
          >
            âœï¸ Editar InformaciÃ³n
          </button>
          <button 
            className="btn btn-outline"
            onClick={() => navigate('/masters/employees')}
          >
            â† Volver a la Lista
          </button>
        </div>
      </div>
    </div>
  );
};

export default EmployeeDetailPage;

'''

### features/payroll/pages/EmployeeFormPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { getEmployeeById, createEmployee, updateEmployee } from '../api/employees';
import '../styles/EmployeeFormPage.css';

const EmployeeFormPage = () => {
  const navigate = useNavigate();
  const { id } = useParams();
  const isEdit = Boolean(id);

  const [formData, setFormData] = useState({
    nombre: '',
    dni: '',
    puesto: '',
    sueldoBase: '',
    estado: 'ACTIVO'
  });

  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    if (isEdit) {
      if (!id || id === 'undefined') {
        setError('ID de empleado no vÃ¡lido');
        return;
      }
      loadEmployee();
    }
  }, [id]);

  const loadEmployee = async () => {
    try {
      setLoading(true);
      const data = await getEmployeeById(id);
      
      setFormData({
        nombre: data.nombre || '',
        dni: data.dni || '',
        puesto: data.puesto || '',
        sueldoBase: data.sueldoBase || '',
        estado: data.estado || 'ACTIVO'
      });
    } catch (err) {
      setError('Error al cargar empleado: ' + err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError(null);

    try {
      setLoading(true);
      
      const dataToSend = {
        nombre: formData.nombre,
        dni: formData.dni,
        puesto: formData.puesto,
        sueldoBase: parseFloat(formData.sueldoBase),
        estado: formData.estado
      };

      if (isEdit) {
        await updateEmployee(id, dataToSend);
        alert('Empleado actualizado correctamente');
      } else {
        await createEmployee(dataToSend);
        alert('Empleado creado correctamente');
      }
      
      navigate('/masters/employees');
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading && isEdit) return <div className="loading">Cargando...</div>;

  return (
    <div className="employee-form-page">
      <div className="form-header">
        <h1>{isEdit ? 'Editar Empleado' : 'Nuevo Empleado'}</h1>
        <button 
          className="btn btn-secondary"
          onClick={() => navigate('/masters/employees')}
        >
          â† Volver
        </button>
      </div>

      {error && <div className="error-message">{error}</div>}

      <form onSubmit={handleSubmit} className="employee-form">
        <div className="form-section">
          <h3>InformaciÃ³n del Empleado</h3>
          <p className="form-note">Complete solo los campos que se guardarÃ¡n en el sistema</p>
          
          <div className="form-row">
            <div className="form-group">
              <label>Nombre Completo *</label>
              <input
                type="text"
                name="nombre"
                value={formData.nombre}
                onChange={handleChange}
                placeholder="Ej: Juan PÃ©rez LÃ³pez"
                required
              />
              <small>Ingrese el nombre completo del empleado</small>
            </div>

            <div className="form-group">
              <label>DNI *</label>
              <input
                type="text"
                name="dni"
                value={formData.dni}
                onChange={handleChange}
                placeholder="12345678"
                maxLength="8"
                pattern="[0-9]{8}"
                required
              />
              <small>Documento Nacional de Identidad (8 dÃ­gitos)</small>
            </div>
          </div>

          <div className="form-row">
            <div className="form-group">
              <label>Puesto/Cargo *</label>
              <input
                type="text"
                name="puesto"
                value={formData.puesto}
                onChange={handleChange}
                placeholder="Ej: Gerente, Asistente, Operario"
                required
              />
            </div>

            <div className="form-group">
              <label>Sueldo Base (S/) *</label>
              <input
                type="number"
                step="0.01"
                min="0"
                name="sueldoBase"
                value={formData.sueldoBase}
                onChange={handleChange}
                placeholder="0.00"
                required
              />
              <small>Monto mensual base antes de descuentos</small>
            </div>
          </div>

          <div className="form-row">
            <div className="form-group">
              <label>Estado *</label>
              <select
                name="estado"
                value={formData.estado}
                onChange={handleChange}
                required
              >
                <option value="ACTIVO">Activo</option>
                <option value="INACTIVO">Inactivo</option>
              </select>
              <small>Solo empleados ACTIVOS aparecerÃ¡n en planillas</small>
            </div>
          </div>
        </div>

        <div className="form-actions">
          <button 
            type="button" 
            className="btn btn-secondary"
            onClick={() => navigate('/masters/employees')}
          >
            Cancelar
          </button>
          <button 
            type="submit" 
            className="btn btn-primary"
            disabled={loading}
          >
            {loading ? 'Guardando...' : (isEdit ? 'Actualizar' : 'Crear Empleado')}
          </button>
        </div>
      </form>
    </div>
  );
};

export default EmployeeFormPage;

'''

### features/payroll/pages/EmployeeListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { getAllEmployees, deleteEmployee, changeEmployeeStatus } from '../api/employees';
import '../styles/EmployeeListPage.css';

const EmployeeListPage = () => {
  const navigate = useNavigate();
  const [employees, setEmployees] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [filterEstado, setFilterEstado] = useState('');
  const [searchTerm, setSearchTerm] = useState('');

  useEffect(() => {
    loadEmployees();
  }, [filterEstado]);

  const loadEmployees = async () => {
    try {
      setLoading(true);
      const data = await getAllEmployees(filterEstado || null);
      // Filtrar empleados ELIMINADOS por defecto
      const filteredData = data.filter(emp => emp.estado !== 'ELIMINADO');
      setEmployees(filteredData);
      setError(null);
    } catch (err) {
      setError('Error al cargar empleados: ' + err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (id) => {
    if (!window.confirm('Â¿EstÃ¡ seguro de eliminar este empleado?')) return;
    
    try {
      await deleteEmployee(id);
      alert('Empleado eliminado correctamente');
      loadEmployees();
    } catch (err) {
      alert('Error al eliminar: ' + err.message);
    }
  };

  const handleChangeStatus = async (id, currentStatus) => {
    const newStatus = currentStatus === 'ACTIVO' ? 'INACTIVO' : 'ACTIVO';
    
    try {
      await changeEmployeeStatus(id, newStatus);
      alert(`Empleado ${newStatus === 'ACTIVO' ? 'activado' : 'inactivado'} correctamente`);
      loadEmployees();
    } catch (err) {
      alert('Error al cambiar estado: ' + err.message);
    }
  };

  const filteredEmployees = employees.filter(emp => {
    const searchLower = searchTerm.toLowerCase();
    return (
      emp.nombre?.toLowerCase().includes(searchLower) ||
      emp.dni?.includes(searchTerm) ||
      emp.puesto?.toLowerCase().includes(searchLower)
    );
  });

  if (loading) return <div className="loading">Cargando empleados...</div>;
  if (error) return <div className="error-message">{error}</div>;

  return (
    <div className="employee-list-page">
      <div className="page-header">
        <h1>GestiÃ³n de Empleados</h1>
        <button 
          className="btn btn-primary"
          onClick={() => navigate('/masters/employees/new')}
        >
          â• Nuevo Empleado
        </button>
      </div>

      <div className="filters-section">
        <input
          type="text"
          placeholder="ğŸ” Buscar por nombre, DNI, puesto..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="search-input"
        />
        
        <select 
          value={filterEstado} 
          onChange={(e) => setFilterEstado(e.target.value)}
          className="filter-select"
        >
          <option key="all" value="">Todos los estados</option>
          <option key="activo" value="ACTIVO">Activos</option>
          <option key="inactivo" value="INACTIVO">Inactivos</option>
          <option key="vacaciones" value="VACACIONES">Vacaciones</option>
          <option key="licencia" value="LICENCIA">Licencia</option>
        </select>

        <button onClick={loadEmployees} className="btn btn-secondary">
          ğŸ”„ Actualizar
        </button>
      </div>

      <div className="employees-count">
        Total: {filteredEmployees.length} empleados
      </div>

      <div className="table-container">
        <table className="employees-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>DNI</th>
              <th>Nombre</th>
              <th>Puesto</th>
              <th>Sueldo Base</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {filteredEmployees.length === 0 ? (
              <tr>
                <td colSpan="7" className="no-data">
                  No se encontraron empleados
                </td>
              </tr>
            ) : (
              filteredEmployees.map(emp => (
                <tr key={emp.id || emp.idEmpleado}>
                  <td>{emp.id || emp.idEmpleado}</td>
                  <td>{emp.dni}</td>
                  <td>{emp.nombre}</td>
                  <td>{emp.puesto}</td>
                  <td className="text-right">
                    S/ {emp.sueldoBase?.toFixed(2) || '0.00'}
                  </td>
                  <td>
                    <span className={`badge badge-${emp.estado?.toLowerCase()}`}>
                      {emp.estado}
                    </span>
                  </td>
                  <td className="actions-cell">
                    <button
                      className="btn-icon btn-view"
                      onClick={() => {
                        const empId = emp.id || emp.idEmpleado;
                        console.log('Ver detalles - ID:', empId);
                        navigate(`/masters/employees/${empId}`);
                      }}
                      title="Ver detalles"
                    >
                      ğŸ‘ï¸
                    </button>
                    <button
                      className="btn-icon btn-edit"
                      onClick={() => {
                        const empId = emp.id || emp.idEmpleado;
                        console.log('Editar - ID:', empId);
                        navigate(`/masters/employees/${empId}/edit`);
                      }}
                      title="Editar"
                    >
                      âœï¸
                    </button>
                    <button
                      className="btn-icon btn-toggle"
                      onClick={() => {
                        const empId = emp.id || emp.idEmpleado;
                        console.log('Cambiar estado - ID:', empId, 'Estado actual:', emp.estado);
                        handleChangeStatus(empId, emp.estado);
                      }}
                      title={emp.estado === 'ACTIVO' ? 'Desactivar' : 'Activar'}
                    >
                      {emp.estado === 'ACTIVO' ? 'ğŸ”´' : 'ğŸŸ¢'}
                    </button>
                    <button
                      className="btn-icon btn-delete"
                      onClick={() => {
                        const empId = emp.id || emp.idEmpleado;
                        console.log('Eliminar - ID:', empId);
                        handleDelete(empId);
                      }}
                      title="Eliminar"
                    >
                      ğŸ—‘ï¸
                    </button>
                  </td>
                </tr>
              ))
            )}
          </tbody>
        </table>
      </div>
    </div>
  );
};

export default EmployeeListPage;

'''

### features/payroll/pages/LiquidationProcessPage.jsx
'''
import React from 'react';

const LiquidationProcessPage = () => {
  return (
    <div className="liquidation-process-page">
      <h1>Proceso de LiquidaciÃ³n</h1>
      <p>MÃ³dulo de proceso de liquidaciÃ³n de planilla - En desarrollo</p>
    </div>
  );
};

export default LiquidationProcessPage;
'''

### features/payroll/pages/MastersConfigPage.jsx
'''
import React from 'react';
import '../styles/MastersConfigPage.css';

const MastersConfigPage = () => {
  return (
    <div className="masters-config-page">
      <div className="page-header">
        <h1>ğŸ“Š ConfiguraciÃ³n de Maestros y FÃ³rmulas</h1>
        <p className="subtitle">InformaciÃ³n sobre los datos maestros y cÃ¡lculos del sistema de planillas</p>
      </div>

      {/* Datos Maestros */}
      <div className="config-section">
        <h2>ğŸ‘¥ Datos Maestros de Empleados</h2>
        <div className="info-card">
          <h3>Campos Almacenados</h3>
          <ul className="field-list">
            <li><strong>ID:</strong> Identificador Ãºnico generado automÃ¡ticamente</li>
            <li><strong>Nombre Completo:</strong> Nombre y apellidos del empleado</li>
            <li><strong>DNI:</strong> Documento Nacional de Identidad (8 dÃ­gitos, Ãºnico)</li>
            <li><strong>Puesto:</strong> Cargo o posiciÃ³n del empleado</li>
            <li><strong>Sueldo Base:</strong> RemuneraciÃ³n mensual base antes de descuentos</li>
            <li><strong>Estado:</strong> ACTIVO, INACTIVO o ELIMINADO</li>
            <li><strong>Fecha de CreaciÃ³n:</strong> Registro automÃ¡tico de alta en el sistema</li>
          </ul>
          <div className="note-box">
            <strong>âš ï¸ Nota importante:</strong> Solo empleados con estado ACTIVO son incluidos en el cÃ¡lculo de planillas.
          </div>
        </div>
      </div>

      {/* Datos de Planilla */}
      <div className="config-section">
        <h2>ğŸ“‹ Datos Maestros de Planillas</h2>
        <div className="info-card">
          <h3>Campos Almacenados</h3>
          <ul className="field-list">
            <li><strong>ID:</strong> Identificador Ãºnico de la planilla</li>
            <li><strong>Periodo:</strong> Formato YYYYMM (ej: 202512 = Diciembre 2025)</li>
            <li><strong>Estado:</strong> BORRADOR â†’ CALCULADO â†’ APROBADO</li>
            <li><strong>Total Bruto:</strong> Suma de todos los sueldos brutos</li>
            <li><strong>Total Neto:</strong> Suma de todos los sueldos netos</li>
            <li><strong>Fecha de CreaciÃ³n:</strong> Registro automÃ¡tico</li>
          </ul>
          <div className="note-box">
            <strong>ğŸ“Œ Flujo de Estados:</strong>
            <ol>
              <li>BORRADOR: Planilla creada, pendiente de cÃ¡lculo</li>
              <li>CALCULADO: Remuneraciones calculadas, lista para revisiÃ³n</li>
              <li>APROBADO: Planilla finalizada y bloqueada</li>
            </ol>
          </div>
        </div>
      </div>

      {/* FÃ³rmulas de CÃ¡lculo */}
      <div className="config-section">
        <h2>ğŸ§® FÃ³rmulas de CÃ¡lculo de Planilla</h2>
        
        <div className="formula-card">
          <h3>1. Sueldo Bruto</h3>
          <div className="formula-box">
            <code>Sueldo Bruto = Sueldo Base del Empleado</code>
          </div>
          <p className="formula-desc">El sueldo bruto es el monto base antes de cualquier descuento o aporte.</p>
        </div>

        <div className="formula-card">
          <h3>2. Descuentos del Empleado</h3>
          <div className="formula-box">
            <code>Descuentos = Sueldo Bruto Ã— 13%</code>
          </div>
          <p className="formula-desc">Incluye AFP/ONP (pensiones) del empleado. Porcentaje aplicado: 13%</p>
          <div className="example-box">
            <strong>Ejemplo:</strong> Si Sueldo Bruto = S/ 5,000.00<br/>
            Descuentos = 5,000 Ã— 0.13 = <strong>S/ 650.00</strong>
          </div>
        </div>

        <div className="formula-card">
          <h3>3. Aportes del Empleador</h3>
          <div className="formula-box">
            <code>Aportes = Sueldo Bruto Ã— 9%</code>
          </div>
          <p className="formula-desc">Contribuciones del empleador a EsSalud. Porcentaje aplicado: 9%</p>
          <div className="example-box">
            <strong>Ejemplo:</strong> Si Sueldo Bruto = S/ 5,000.00<br/>
            Aportes = 5,000 Ã— 0.09 = <strong>S/ 450.00</strong>
          </div>
        </div>

        <div className="formula-card highlight">
          <h3>4. Sueldo Neto (A Pagar)</h3>
          <div className="formula-box">
            <code>Sueldo Neto = Sueldo Bruto - Descuentos</code>
          </div>
          <p className="formula-desc">Es el monto que efectivamente recibe el empleado despuÃ©s de descuentos.</p>
          <div className="example-box">
            <strong>Ejemplo Completo:</strong><br/>
            â€¢ Sueldo Bruto: S/ 5,000.00<br/>
            â€¢ Descuentos (13%): S/ 650.00<br/>
            â€¢ Sueldo Neto: 5,000 - 650 = <strong>S/ 4,350.00</strong>
          </div>
        </div>

        <div className="formula-card">
          <h3>5. Totales de Planilla</h3>
          <div className="formula-box">
            <code>Total Bruto = Î£ (Sueldo Bruto de cada empleado)</code><br/>
            <code>Total Neto = Î£ (Sueldo Neto de cada empleado)</code>
          </div>
          <p className="formula-desc">La suma de todos los empleados activos incluidos en la planilla.</p>
        </div>
      </div>

      {/* ParÃ¡metros del Sistema */}
      <div className="config-section">
        <h2>âš™ï¸ ParÃ¡metros Actuales del Sistema</h2>
        <div className="params-grid">
          <div className="param-card">
            <div className="param-icon">ğŸ“Š</div>
            <div className="param-info">
              <h4>Descuento AFP/ONP</h4>
              <p className="param-value">13%</p>
              <p className="param-desc">Aplicado sobre sueldo bruto</p>
            </div>
          </div>
          
          <div className="param-card">
            <div className="param-icon">ğŸ¥</div>
            <div className="param-info">
              <h4>Aporte EsSalud</h4>
              <p className="param-value">9%</p>
              <p className="param-desc">Asumido por el empleador</p>
            </div>
          </div>
          
          <div className="param-card">
            <div className="param-icon">ğŸ’°</div>
            <div className="param-info">
              <h4>Sueldo MÃ­nimo</h4>
              <p className="param-value">S/ 1,025.00</p>
              <p className="param-desc">RMV vigente 2025</p>
            </div>
          </div>
          
          <div className="param-card">
            <div className="param-icon">ğŸ”¢</div>
            <div className="param-info">
              <h4>Redondeo</h4>
              <p className="param-value">2 decimales</p>
              <p className="param-desc">Todos los montos en soles</p>
            </div>
          </div>
        </div>
      </div>

      {/* Validaciones */}
      <div className="config-section">
        <h2>âœ… Validaciones del Sistema</h2>
        <div className="validation-grid">
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>DNI Ãºnico:</strong> No se permite duplicar DNI entre empleados
            </div>
          </div>
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>Periodo Ãºnico:</strong> Solo una planilla por periodo (YYYYMM)
            </div>
          </div>
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>Sueldo base positivo:</strong> Debe ser mayor a cero
            </div>
          </div>
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>Solo empleados activos:</strong> Estado debe ser ACTIVO para incluir en planilla
            </div>
          </div>
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>CÃ¡lculo en BORRADOR:</strong> Solo se puede calcular planillas en estado BORRADOR
            </div>
          </div>
          <div className="validation-item">
            <span className="check-icon">âœ“</span>
            <div>
              <strong>AprobaciÃ³n en CALCULADO:</strong> Solo se puede aprobar planillas CALCULADAS
            </div>
          </div>
        </div>
      </div>

      {/* Notas Finales */}
      <div className="config-section">
        <div className="info-banner">
          <h3>ğŸ“ Notas Importantes</h3>
          <ul>
            <li>Los porcentajes de descuentos y aportes son valores fijos configurados en el backend</li>
            <li>Una vez APROBADA, una planilla no puede ser modificada ni recalculada</li>
            <li>Los empleados con estado ELIMINADO permanecen en planillas histÃ³ricas pero no se incluyen en nuevas planillas</li>
            <li>El periodo debe ser Ãºnico - no se pueden crear dos planillas para el mismo mes/aÃ±o</li>
            <li>Todos los cÃ¡lculos se realizan con precisiÃ³n de 2 decimales</li>
          </ul>
        </div>
      </div>
    </div>
  );
};

export default MastersConfigPage;
'''

### features/payroll/pages/PayrollDashboardPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { getAllPayrolls } from '../api/payroll';
import { getAllEmployees } from '../api/employees';
import '../styles/PayrollDashboardPage.css';

const PayrollDashboardPage = () => {
  const navigate = useNavigate();
  const [stats, setStats] = useState({
    totalEmpleados: 0,
    empleadosActivos: 0,
    planillasDelMes: 0,
    totalNomina: 0
  });
  const [recentPayrolls, setRecentPayrolls] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadDashboardData();
  }, []);

  const loadDashboardData = async () => {
    try {
      setLoading(true);
      
      // Cargar empleados
      const employees = await getAllEmployees();
      console.log('ğŸ“Š [Dashboard] Total empleados:', employees.length, employees);
      const activeEmployees = employees.filter(e => e.estado === 'ACTIVO');
      console.log('ğŸ“Š [Dashboard] Empleados activos:', activeEmployees.length);
      
      // Cargar planillas
      const payrolls = await getAllPayrolls();
      console.log('ğŸ“Š [Dashboard] Todas las planillas:', payrolls);
      console.log('ğŸ“Š [Dashboard] Primera planilla completa:', payrolls[0]);
      
      const currentMonth = new Date().getMonth() + 1;
      const currentYear = new Date().getFullYear();
      console.log('ğŸ“Š [Dashboard] Mes/AÃ±o actual:', currentMonth, '/', currentYear);
      console.log('ğŸ“Š [Dashboard] Buscando periodo:', `${currentYear}${currentMonth.toString().padStart(2, '0')}`);
      
      // La planilla usa formato YYYYMM en el campo "periodo", no campos separados mes/anio
      const currentPeriod = `${currentYear}${currentMonth.toString().padStart(2, '0')}`; // "202512"
      const monthPayrolls = payrolls.filter(p => p.periodo === currentPeriod);
      console.log('ğŸ“Š [Dashboard] Planillas del mes actual (por periodo):', monthPayrolls);

      // Calcular total de nÃ³mina del mes
      const totalNomina = monthPayrolls.reduce((sum, p) => sum + (p.totalNeto || 0), 0);
      console.log('ğŸ“Š [Dashboard] Total nÃ³mina del mes:', totalNomina);

      setStats({
        totalEmpleados: employees.length,
        empleadosActivos: activeEmployees.length,
        planillasDelMes: monthPayrolls.length,
        totalNomina: totalNomina
      });

      // Obtener Ãºltimas 5 planillas
      const sorted = [...payrolls].sort((a, b) => b.id - a.id);
      console.log('ğŸ“Š [Dashboard] Ãšltimas 5 planillas:', sorted.slice(0, 5));
      setRecentPayrolls(sorted.slice(0, 5));

    } catch (error) {
      console.error('âŒ [Dashboard] Error loading dashboard:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return <div className="loading">Cargando dashboard...</div>;
  }

  return (
    <div className="payroll-dashboard-page">
      <h1>Dashboard de Planilla</h1>

      <div className="stats-grid">
        <div className="stat-card blue">
          <div className="stat-icon">ğŸ‘¥</div>
          <div className="stat-info">
            <h3>{stats.totalEmpleados}</h3>
            <p>Total Empleados</p>
          </div>
        </div>

        <div className="stat-card green">
          <div className="stat-icon">âœ…</div>
          <div className="stat-info">
            <h3>{stats.empleadosActivos}</h3>
            <p>Empleados Activos</p>
          </div>
        </div>

        <div className="stat-card orange">
          <div className="stat-icon">ğŸ“Š</div>
          <div className="stat-info">
            <h3>{stats.planillasDelMes}</h3>
            <p>Planillas del Mes</p>
          </div>
        </div>

        <div className="stat-card purple">
          <div className="stat-icon">ğŸ’°</div>
          <div className="stat-info">
            <h3>S/ {stats.totalNomina.toFixed(2)}</h3>
            <p>Total NÃ³mina del Mes</p>
          </div>
        </div>
      </div>

      <div className="dashboard-actions">
        <button 
          className="action-btn primary"
          onClick={() => navigate('/masters/employees')}
        >
          ğŸ‘¥ Gestionar Empleados
        </button>
        <button 
          className="action-btn secondary"
          onClick={() => navigate('/payroll/list')}
        >
          ğŸ“‹ Ver Planillas
        </button>
        <button 
          className="action-btn success"
          onClick={() => navigate('/payroll/novelties')}
        >
          âœï¸ Registrar Novedades
        </button>
      </div>

      <div className="recent-payrolls">
        <h2>Planillas Recientes</h2>
        {recentPayrolls.length === 0 ? (
          <p className="no-data">No hay planillas registradas</p>
        ) : (
          <table className="payrolls-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Periodo</th>
                <th>Estado</th>
                <th>Empleados</th>
                <th>Total Bruto</th>
                <th>Total Neto</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              {recentPayrolls.map(payroll => (
                <tr key={payroll.id}>
                  <td>{payroll.id}</td>
                  <td>{payroll.periodo}</td>
                  <td>
                    <span className={`badge badge-${payroll.estado?.toLowerCase()}`}>
                      {payroll.estado}
                    </span>
                  </td>
                  <td>{payroll.remuneraciones?.length || 0}</td>
                  <td>S/ {payroll.totalBruto?.toFixed(2) || '0.00'}</td>
                  <td>S/ {payroll.totalNeto?.toFixed(2) || '0.00'}</td>
                  <td>
                    <button
                      className="btn-sm"
                      onClick={() => navigate(`/payroll/${payroll.id}`)}
                    >
                      Ver Detalles
                    </button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );
};

export default PayrollDashboardPage;
'''

### features/payroll/pages/PayrollDetailPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { getPayrollById } from '../api/payroll';
import '../styles/PayrollDetailPage.css';

const PayrollDetailPage = () => {
  const { id } = useParams();
  const navigate = useNavigate();
  const [payroll, setPayroll] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    loadPayrollData();
  }, [id]);

  const loadPayrollData = async () => {
    try {
      setLoading(true);
      const data = await getPayrollById(id);
      console.log('ğŸ“‹ Datos de planilla:', data);
      setPayroll(data);
      setError(null);
    } catch (err) {
      setError('Error al cargar planilla: ' + err.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <div className="loading">Cargando planilla...</div>;
  if (error) return <div className="error-message">{error}</div>;
  if (!payroll) return <div className="error-message">Planilla no encontrada</div>;

  return (
    <div className="payroll-detail-page">
      <div className="page-header">
        <h1>Detalle de Planilla {payroll.periodo}</h1>
        <div className="header-actions">
          <button 
            className="btn btn-secondary"
            onClick={() => navigate('/payroll/list')}
          >
            â† Volver
          </button>
          {payroll.estado === 'BORRADOR' && (
            <button 
              className="btn btn-primary"
              onClick={() => navigate(`/payroll/${id}/edit`)}
            >
              âœï¸ Editar
            </button>
          )}
        </div>
      </div>

      <div className="payroll-detail-card">
        {/* InformaciÃ³n General */}
        <div className="detail-section">
          <h3>InformaciÃ³n General</h3>
          <div className="detail-grid">
            <div className="detail-item">
              <label>ID</label>
              <span>{payroll.id || payroll.idPlanilla}</span>
            </div>
            <div className="detail-item">
              <label>Periodo</label>
              <span>{payroll.periodo}</span>
            </div>
            <div className="detail-item">
              <label>Estado</label>
              <span className={`badge badge-${payroll.estado?.toLowerCase()}`}>
                {payroll.estado}
              </span>
            </div>
            <div className="detail-item">
              <label>Fecha de CreaciÃ³n</label>
              <span>{payroll.createdAt ? new Date(payroll.createdAt).toLocaleDateString() : 'No disponible'}</span>
            </div>
          </div>
        </div>

        {/* Totales */}
        <div className="detail-section">
          <h3>Totales</h3>
          <div className="totals-grid">
            <div className="total-card">
              <label>Total Bruto</label>
              <span className="amount">S/ {payroll.totalBruto?.toFixed(2) || '0.00'}</span>
            </div>
            <div className="total-card">
              <label>Total Descuentos</label>
              <span className="amount">S/ {(payroll.totalBruto - payroll.totalNeto)?.toFixed(2) || '0.00'}</span>
            </div>
            <div className="total-card highlight">
              <label>Total Neto</label>
              <span className="amount">S/ {payroll.totalNeto?.toFixed(2) || '0.00'}</span>
            </div>
          </div>
        </div>

        {/* Empleados incluidos */}
        {payroll.remuneraciones && payroll.remuneraciones.length > 0 && (
          <div className="detail-section">
            <h3>Empleados Incluidos ({payroll.remuneraciones.length})</h3>
            <div className="table-container">
              <table className="remuneraciones-table">
                <thead>
                  <tr>
                    <th>Empleado</th>
                    <th>DNI</th>
                    <th>Puesto</th>
                    <th className="text-right">Sueldo Bruto</th>
                    <th className="text-right">Descuentos</th>
                    <th className="text-right">Aportes Empleador</th>
                    <th className="text-right">Sueldo Neto</th>
                  </tr>
                </thead>
                <tbody>
                  {payroll.remuneraciones.map((rem, idx) => (
                    <tr key={idx}>
                      <td>{rem.empleadoNombre || 'N/A'}</td>
                      <td>{rem.empleadoDni || 'N/A'}</td>
                      <td>{rem.empleadoPuesto || 'N/A'}</td>
                      <td className="text-right">S/ {rem.sueldoBruto?.toFixed(2)}</td>
                      <td className="text-right">S/ {rem.descuentos?.toFixed(2)}</td>
                      <td className="text-right">S/ {rem.aportes?.toFixed(2)}</td>
                      <td className="text-right highlight">S/ {rem.sueldoNeto?.toFixed(2)}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}

        {(!payroll.remuneraciones || payroll.remuneraciones.length === 0) && (
          <div className="detail-section">
            <div className="empty-state">
              <p>Esta planilla aÃºn no tiene empleados calculados.</p>
              {payroll.estado === 'BORRADOR' && (
                <p>Vaya a "RevisiÃ³n de Pre-NÃ³mina" para calcular las remuneraciones.</p>
              )}
            </div>
          </div>
        )}

        <div className="detail-actions">
          <button 
            className="btn btn-outline"
            onClick={() => navigate('/payroll/list')}
          >
            â† Volver a la Lista
          </button>
          {payroll.estado === 'APROBADA' && (
            <button 
              className="btn btn-success"
              onClick={() => navigate('/payroll/outputs')}
            >
              ğŸ“„ Generar Archivos
            </button>
          )}
        </div>
      </div>
    </div>
  );
};

export default PayrollDetailPage;

'''

### features/payroll/pages/PayrollFormPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { getPayrollById, createPayroll, updatePayroll } from '../api/payroll';
import '../styles/PayrollFormPage.css';

const PayrollFormPage = () => {
  const navigate = useNavigate();
  const { id } = useParams();
  const isEdit = Boolean(id);

  const [formData, setFormData] = useState({
    periodo: '',
    mes: '',
    anio: new Date().getFullYear()
  });

  const [loading, setLoading] = useState(false);
  const [loadingData, setLoadingData] = useState(isEdit);

  useEffect(() => {
    if (isEdit) {
      loadPayrollData();
    } else {
      // Establecer periodo actual
      const now = new Date();
      const currentPeriod = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}`;
      setFormData(prev => ({
        ...prev,
        periodo: currentPeriod,
        mes: now.getMonth() + 1,
        anio: now.getFullYear()
      }));
    }
  }, [id]);

  const loadPayrollData = async () => {
    try {
      const data = await getPayrollById(id);
      // Extraer mes y aÃ±o del periodo (formato: YYYYMM)
      const periodo = data.periodo || '';
      const anio = periodo.substring(0, 4);
      const mes = periodo.substring(4, 6);
      
      setFormData({
        periodo: periodo,
        mes: parseInt(mes) || '',
        anio: parseInt(anio) || new Date().getFullYear()
      });
    } catch (error) {
      alert('Error al cargar datos de la planilla');
      navigate('/payroll');
    } finally {
      setLoadingData(false);
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));

    // Actualizar periodo cuando cambian mes o aÃ±o
    if (name === 'mes' || name === 'anio') {
      const mes = name === 'mes' ? value : formData.mes;
      const anio = name === 'anio' ? value : formData.anio;
      if (mes && anio) {
        const periodo = `${anio}${String(mes).padStart(2, '0')}`;
        setFormData(prev => ({ ...prev, periodo }));
      }
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    try {
      setLoading(true);

      const dataToSend = {
        periodo: formData.periodo,
        presupuestoId: 1 // ID del presupuesto por defecto
      };

      if (isEdit) {
        await updatePayroll(id, dataToSend);
        alert('Planilla actualizada correctamente');
      } else {
        await createPayroll(dataToSend);
        alert('Planilla creada correctamente');
      }

      navigate('/payroll');
    } catch (error) {
      alert(`Error al ${isEdit ? 'actualizar' : 'crear'} planilla: ` + error.message);
    } finally {
      setLoading(false);
    }
  };

  if (loadingData) {
    return <div className="loading">Cargando datos...</div>;
  }

  return (
    <div className="payroll-form-page">
      <div className="form-header">
        <h1>{isEdit ? 'Editar Planilla' : 'Nueva Planilla'}</h1>
        <button onClick={() => navigate('/payroll')} className="btn btn-secondary">
          â† Volver
        </button>
      </div>

      <form onSubmit={handleSubmit} className="payroll-form">
        <div className="form-section">
          <h3>InformaciÃ³n de la Planilla</h3>
          <p className="form-note">Seleccione el periodo para el cual se generarÃ¡ la planilla</p>

          <div className="form-row">
            <div className="form-group">
              <label>Mes *</label>
              <select
                name="mes"
                value={formData.mes}
                onChange={handleChange}
                required
              >
                <option value="">Seleccione mes</option>
                <option value="1">Enero</option>
                <option value="2">Febrero</option>
                <option value="3">Marzo</option>
                <option value="4">Abril</option>
                <option value="5">Mayo</option>
                <option value="6">Junio</option>
                <option value="7">Julio</option>
                <option value="8">Agosto</option>
                <option value="9">Septiembre</option>
                <option value="10">Octubre</option>
                <option value="11">Noviembre</option>
                <option value="12">Diciembre</option>
              </select>
            </div>

            <div className="form-group">
              <label>AÃ±o *</label>
              <input
                type="number"
                name="anio"
                value={formData.anio}
                onChange={handleChange}
                min="2020"
                max="2030"
                required
              />
            </div>
          </div>

          <div className="form-group">
            <label>Periodo (formato: YYYYMM)</label>
            <input
              type="text"
              value={formData.periodo}
              disabled
              className="input-disabled"
            />
            <small>Este campo se genera automÃ¡ticamente a partir del mes y aÃ±o seleccionado</small>
          </div>

          <div className="info-box">
            <strong>Nota importante:</strong>
            <ul>
              <li>Solo se puede crear una planilla por periodo</li>
              <li>La planilla se crearÃ¡ en estado BORRADOR</li>
              <li>DespuÃ©s de crearla, deberÃ¡ calcular las remuneraciones</li>
              <li>Solo empleados en estado ACTIVO serÃ¡n incluidos</li>
            </ul>
          </div>
        </div>

        <div className="form-actions">
          <button type="button" onClick={() => navigate('/payroll')} className="btn btn-secondary">
            Cancelar
          </button>
          <button type="submit" className="btn btn-primary" disabled={loading}>
            {loading ? 'Guardando...' : (isEdit ? 'Actualizar' : 'Crear') + ' Planilla'}
          </button>
        </div>
      </form>
    </div>
  );
};

export default PayrollFormPage;

'''

### features/payroll/pages/PayrollListPage.jsx
'''
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { getAllPayrolls, deletePayroll, calculatePayroll, approvePayroll } from '../api/payroll';
import '../styles/PayrollListPage.css';

const PayrollListPage = () => {
  const navigate = useNavigate();
  const [payrolls, setPayrolls] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [filterEstado, setFilterEstado] = useState('');
  const [searchTerm, setSearchTerm] = useState('');

  useEffect(() => {
    loadPayrolls();
  }, [filterEstado]);

  const loadPayrolls = async () => {
    try {
      setLoading(true);
      const data = await getAllPayrolls();
      
      let filtered = data;
      if (filterEstado) {
        filtered = data.filter(p => p.estado === filterEstado);
      }
      
      setPayrolls(filtered);
      setError(null);
    } catch (err) {
      setError('Error al cargar planillas: ' + err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleCalculate = async (id) => {
    if (!window.confirm('Â¿EstÃ¡ seguro de calcular esta planilla?')) return;
    
    try {
      await calculatePayroll(id);
      alert('Planilla calculada correctamente');
      loadPayrolls();
    } catch (err) {
      alert('Error al calcular: ' + err.message);
    }
  };

  const handleApprove = async (id) => {
    if (!window.confirm('Â¿EstÃ¡ seguro de aprobar esta planilla?')) return;
    
    try {
      await approvePayroll(id);
      alert('Planilla aprobada correctamente');
      loadPayrolls();
    } catch (err) {
      alert('Error al aprobar: ' + err.message);
    }
  };

  const handleDelete = async (id) => {
    if (!window.confirm('Â¿EstÃ¡ seguro de eliminar esta planilla?')) return;
    
    try {
      await deletePayroll(id);
      alert('Planilla eliminada correctamente');
      loadPayrolls();
    } catch (err) {
      alert('Error al eliminar: ' + err.message);
    }
  };

  const getEstadoBadge = (estado) => {
    const badges = {
      'BORRADOR': 'badge-draft',
      'CALCULADO': 'badge-calculated',
      'APROBADO': 'badge-approved'
    };
    return badges[estado] || 'badge-default';
  };

  const filteredPayrolls = payrolls.filter(payroll => {
    const searchLower = searchTerm.toLowerCase();
    return (
      payroll.periodo?.toLowerCase().includes(searchLower) ||
      payroll.estado?.toLowerCase().includes(searchLower)
    );
  });

  if (loading) return <div className="loading">Cargando planillas...</div>;
  if (error) return <div className="error-message">{error}</div>;

  return (
    <div className="payroll-list-page">
      <div className="page-header">
        <h1>GestiÃ³n de Planillas</h1>
        <button 
          className="btn btn-primary"
          onClick={() => navigate('/payroll/new')}
        >
          â• Nueva Planilla
        </button>
      </div>

      <div className="filters-section">
        <input
          type="text"
          placeholder="ğŸ” Buscar por periodo, descripciÃ³n..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="search-input"
        />
        
        <select 
          value={filterEstado} 
          onChange={(e) => setFilterEstado(e.target.value)}
          className="filter-select"
        >
          <option key="all" value="">Todos los estados</option>
          <option key="borrador" value="BORRADOR">Borrador</option>
          <option key="calculado" value="CALCULADO">Calculado</option>
          <option key="aprobado" value="APROBADO">Aprobado</option>
        </select>

        <button onClick={loadPayrolls} className="btn btn-secondary">
          ğŸ”„ Actualizar
        </button>
      </div>

      <div className="stats-row">
        <div className="stat-card">
          <span className="stat-label">Total Planillas</span>
          <span className="stat-value">{payrolls.length}</span>
        </div>
        <div className="stat-card">
          <span className="stat-label">Borradores</span>
          <span className="stat-value">{payrolls.filter(p => p.estado === 'BORRADOR').length}</span>
        </div>
        <div className="stat-card">
          <span className="stat-label">Calculadas</span>
          <span className="stat-value">{payrolls.filter(p => p.estado === 'CALCULADO').length}</span>
        </div>
        <div className="stat-card">
          <span className="stat-label">Aprobadas</span>
          <span className="stat-value">{payrolls.filter(p => p.estado === 'APROBADO').length}</span>
        </div>
      </div>

      <div className="table-container">
        <table className="payroll-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Periodo</th>
              <th>Estado</th>
              <th>Total Bruto</th>
              <th>Total Neto</th>
              <th>Empleados</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {filteredPayrolls.length === 0 ? (
              <tr>
                <td colSpan="7" className="no-data">No hay planillas registradas</td>
              </tr>
            ) : (
              filteredPayrolls.map(payroll => (
                <tr key={payroll.id}>
                  <td>{payroll.id}</td>
                  <td>{payroll.periodo}</td>
                  <td>
                    <span className={`badge ${getEstadoBadge(payroll.estado)}`}>
                      {payroll.estado}
                    </span>
                  </td>
                  <td>S/ {payroll.totalBruto?.toFixed(2) || '0.00'}</td>
                  <td>S/ {payroll.totalNeto?.toFixed(2) || '0.00'}</td>
                  <td>{payroll.remuneraciones?.length || 0}</td>
                  <td className="actions-cell">
                    <button
                      onClick={() => navigate(`/payroll/${payroll.id}`)}
                      className="btn-icon"
                      title="Ver detalles"
                    >
                      ğŸ‘ï¸
                    </button>
                    
                    {payroll.estado === 'BORRADOR' && (
                      <>
                        <button
                          onClick={() => navigate(`/payroll/${payroll.id}/edit`)}
                          className="btn-icon"
                          title="Editar"
                        >
                          âœï¸
                        </button>
                        <button
                          onClick={() => handleCalculate(payroll.id)}
                          className="btn-icon btn-success"
                          title="Calcular"
                        >
                          ğŸ§®
                        </button>
                      </>
                    )}
                    
                    {payroll.estado === 'CALCULADO' && (
                      <button
                        onClick={() => handleApprove(payroll.id)}
                        className="btn-icon btn-success"
                        title="Aprobar"
                      >
                        âœ“
                      </button>
                    )}
                    
                    {payroll.estado !== 'APROBADO' && (
                      <button
                        onClick={() => handleDelete(payroll.id)}
                        className="btn-icon btn-danger"
                        title="Eliminar"
                      >
                        ğŸ—‘ï¸
                      </button>
                    )}
                  </td>
                </tr>
              ))
            )}
          </tbody>
        </table>
      </div>
    </div>
  );
};

export default PayrollListPage;

'''

### features/payroll/pages/ReportsPage.jsx
'''
import React from 'react';

const ReportsPage = () => {
  return (
    <div className="reports-page">
      <h1>Reportes de Planilla</h1>
      <p>MÃ³dulo de reportes de planilla - En desarrollo</p>
    </div>
  );
};

export default ReportsPage;
'''

### features/tax/pages/DailyOpsPage.jsx
'''
import React, { useState } from "react";
import { useApiClient } from "../../../api/tax";
import '../styles/DailyOpsPage.css';

export default function DailyOpsPage() {
  // Estado Venta
  const [ventaRuc, setVentaRuc] = useState("");
  const [items, setItems] = useState([{ productoId: 1, cantidad: 1 }]); // SimulaciÃ³n, deberÃ­as buscar productos
  
  // Estado Compra
  const [compraRuc, setCompraRuc] = useState("");
  const [compraFactura, setCompraFactura] = useState("");
  const [compraMonto, setCompraMonto] = useState(0);
  const [compraFile, setCompraFile] = useState(null);

  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState({ type: "", text: "", file: null });

  const api = useApiClient();

  const handleAddItem = () => {
    setItems([...items, { productoId: 1, cantidad: 1 }]);
  };

  const handleItemChange = (index, field, value) => {
    const newItems = [...items];
    newItems[index][field] = value;
    setItems(newItems);
  };
  
  // --- Proceso 2: Venta ---
  const handleRegistrarVenta = (e) => {
    e.preventDefault();
    setLoading(true);
    setMessage({ type: "", text: "" });

    const ventaData = {
        clienteRucDni: ventaRuc,
        items: items
    };

    api.registrarVenta(ventaData)
      .then(response => {
        setMessage({ type: "success", text: `${response.message} XML: ${response.xml}, PDF: ${response.pdf}`, file: null });
        setLoading(false);
        // Limpiar formulario
        setVentaRuc("");
        setItems([{ productoId: 1, cantidad: 1 }]);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error ValidaciÃ³n: ${err.message}`, file: err.file });
        setLoading(false);
      });
  };

  // --- Proceso 2: Compra ---
  const handleRegistrarCompra = (e) => {
    e.preventDefault();
    setLoading(true);
    setMessage({ type: "", text: "" });

    const formData = new FormData();
    formData.append("proveedorRuc", compraRuc);
    formData.append("numeroFactura", compraFactura);
    formData.append("montoTotal", compraMonto);
    if (compraFile) {
      formData.append("file", compraFile);
    }

    api.registrarCompra(formData)
      .then(response => {
        setMessage({ type: "success", text: response.message, file: null });
        setLoading(false);
        // Limpiar formulario
        setCompraRuc("");
        setCompraFactura("");
        setCompraMonto(0);
        setCompraFile(null);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error ValidaciÃ³n: ${err.message}`, file: err.file });
        setLoading(false);
      });
  };

  return (
    <div className="daily-ops-page">
      <h1>
        OperaciÃ³n Diaria â€“ Ventas y Compras
      </h1>

      {message.text && (
        <div className={`message-box ${message.type === 'success' ? 'success' : 'error'}`}>
          <p>{message.text}</p>
          {message.file && <p>Archivo de error generado: {message.file}</p>}
        </div>
      )}

      <div className="operations-grid">
        {/* Registro de ventas */}
        <form onSubmit={handleRegistrarVenta} className="operation-card">
          <h2>EmisiÃ³n de CPE (Venta)</h2>
          <input
            placeholder="Cliente (RUC/DNI)"
            value={ventaRuc}
            onChange={(e) => setVentaRuc(e.target.value)}
            required
          />
          <h3>Ãtems:</h3>
          {items.map((item, index) => (
            <div key={index} className="item-row">
                <input 
                    type="number"
                    placeholder="ID Producto"
                    value={item.productoId}
                    onChange={(e) => handleItemChange(index, 'productoId', e.target.value)}
                />
                <input
                    type="number"
                    placeholder="Cantidad"
                    value={item.cantidad}
                    onChange={(e) => handleItemChange(index, 'cantidad', e.target.value)}
                />
            </div>
          ))}
          <button type="button" onClick={handleAddItem} className="add-item-btn">+ Agregar Ã­tem</button>
          
          <button type="submit" disabled={loading} className="btn-submit primary">
            {loading ? "Registrando..." : "Generar CPE"}
          </button>
        </form>

        {/* Registro de compras */}
        <form onSubmit={handleRegistrarCompra} className="operation-card">
          <h2>Registro de Compras</h2>
          <input
            placeholder="Proveedor (RUC)"
            value={compraRuc}
            onChange={(e) => setCompraRuc(e.target.value)}
            required
          />
          <input
            placeholder="NÃºmero Factura"
            value={compraFactura}
            onChange={(e) => setCompraFactura(e.target.value)}
            required
          />
          <input
            type="number"
            step="0.01"
            placeholder="Monto Total (inc. IGV)"
            value={compraMonto}
            onChange={(e) => setCompraMonto(e.target.value)}
            required
          />
          <label>Adjuntar XML/PDF (Opcional):</label>
          <input
            type="file"
            onChange={(e) => setCompraFile(e.target.files[0])}
          />
          <button type="submit" disabled={loading} className="btn-submit green">
            {loading ? "Registrando..." : "Registrar Compra"}
          </button>
        </form>
      </div>
    </div>
  );
}
'''

### features/tax/pages/MonthlyClosingPage.jsx
'''
import React, { useState } from "react";
import { useApiClient } from "../../../api/tax";
import { useAuth } from "../../../hooks/useAuth";
import '../styles/MonthlyClosingPage.css';

export default function MonthlyClosingPage() {
  const [periodo, setPeriodo] = useState(new Date().toISOString().slice(0, 7).replace("-","")); // "YYYYMM"
  const [declaracion, setDeclaracion] = useState(null);
  const [loading, setLoading] = useState(false);
  const [downloading, setDownloading] = useState(null); // Para indicar quÃ© archivo se estÃ¡ descargando
  const [message, setMessage] = useState({ type: "", text: "" });

  const api = useApiClient();
  const { token } = useAuth(); // ObtÃ©n el token actual

  const handleIniciarCierre = () => {
    setLoading(true);
    setMessage({ type: "", text: "" });
    setDeclaracion(null);

    api.iniciarCierre(periodo)
      .then(data => {
        setDeclaracion(data);
        setMessage({ type: "success", text: `CÃ¡lculo para ${periodo} completado. Listo para revisiÃ³n.` });
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error: ${err.message}` });
        setLoading(false);
      });
  };

  const handleAprobar = (aprobado) => {
    if (!declaracion) return;

    setLoading(true);
    setMessage({ type: "", text: "" });

    api.aprobarDeclaracion(declaracion.id, aprobado)
      .then(data => {
        // Actualiza solo los campos necesarios, evita sobreescribir todo si la respuesta es un DTO
         setDeclaracion(prev => ({ ...prev, estado: data.estado }));
        const msg = aprobado ? "DeclaraciÃ³n APROBADA." : "DeclaraciÃ³n RECHAZADA para ajustes.";
        setMessage({ type: "success", text: msg });
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error: ${err.message}` });
        setLoading(false);
      });
  };

  // --- Nueva FunciÃ³n para Descarga Autenticada ---
  const handleDownload = async (tipoArchivo, nombreArchivoSugerido) => {
    if (!declaracion) return;
    setDownloading(tipoArchivo); // Indica que este archivo se estÃ¡ descargando
    setMessage({ type: "", text: "" });

    const url = `http://localhost:8081/api/tax/closing/descargar/${declaracion.id}/${tipoArchivo}`;

    try {
      const response = await fetch(url, {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`, // <-- Â¡AÃ±adir el token!
        },
      });

      if (response.status === 403) {
           setMessage({ type: "error", text: "Error 403: No tienes permiso para descargar este archivo." });
           setDownloading(null);
           return;
      }
      if (!response.ok) {
        throw new Error(`Error al descargar: ${response.statusText}`);
      }

      const blob = await response.blob(); // Obtiene el contenido del archivo como Blob

      // Intenta obtener el nombre del archivo de la cabecera Content-Disposition si existe
      const disposition = response.headers.get('content-disposition');
      let filename = nombreArchivoSugerido; // Usa el nombre sugerido por defecto
      if (disposition && disposition.indexOf('attachment') !== -1) {
          const filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
          const matches = filenameRegex.exec(disposition);
          if (matches != null && matches[1]) {
            filename = matches[1].replace(/['"]/g, '');
          }
      }

      // Crea un enlace temporal para descargar el Blob
      const link = document.createElement('a');
      link.href = window.URL.createObjectURL(blob);
      link.setAttribute('download', filename); // Establece el nombre de archivo
      document.body.appendChild(link);
      link.click(); // Simula el clic para iniciar la descarga
      link.parentNode.removeChild(link); // Limpia el enlace
      window.URL.revokeObjectURL(link.href); // Libera la URL del objeto

    } catch (error) {
      setMessage({ type: "error", text: `Error al descargar ${tipoArchivo}: ${error.message}` });
    } finally {
      setDownloading(null); // Finaliza la indicaciÃ³n de descarga
    }
  };
  // --------------------------------------------------

  return (
    <div className="monthly-closing-page">
      <h1>
        Cierre Mensual y GeneraciÃ³n de Formularios PDT (621)
      </h1>

      {message.text && (
        <div className={`message-box ${message.type === 'success' ? 'success' : 'error'}`}>
          {message.text}
        </div>
      )}

      {/* --- Paso 1: Iniciar Cierre --- */}
      <div className="control-panel">
        <h2>
          ConsolidaciÃ³n y CÃ¡lculo de IGV
        </h2>
        <div className="control-row">
          <label>Periodo:</label>
          <input
            type="text"
            placeholder="YYYYMM"
            value={periodo}
            onChange={(e) => setPeriodo(e.target.value)}
            disabled={loading || downloading}
          />
          <button
            className="btn-primary"
            onClick={handleIniciarCierre}
            disabled={loading || downloading}
          >
            {loading ? "Calculando..." : "Ejecutar CÃ¡lculo"}
          </button>
        </div>
      </div>

      {/* --- Paso 2 y 3: RevisiÃ³n y Descarga --- */}
      {declaracion && (
        <div>
          {/* Resumen */}
          <div className="declaration-card">
            <h2>Resumen del CÃ¡lculo</h2>
            <p><strong>ID:</strong> {declaracion.id}</p>
            <p><strong>Estado:</strong> <span className={`status-badge ${
                declaracion.estado === 'APROBADO_LISTO_PRESENTAR' ? 'approved' :
                declaracion.estado === 'RECHAZADO_AJUSTES' ? 'rejected' : 'pending'
            }`}>{declaracion.estado}</span></p>
            
            <h3>Resumen de Impuestos</h3>
            <div className="summary-grid">
                <div className="summary-item"><strong>IGV DÃ©bito</strong><span>S/ {declaracion.igvDebito?.toFixed(2) ?? 'N/A'}</span></div>
                <div className="summary-item"><strong>IGV CrÃ©dito</strong><span>S/ {declaracion.igvCredito?.toFixed(2) ?? 'N/A'}</span></div>
                <div className="summary-item"><strong>IGV Neto</strong><span>S/ {declaracion.igvNeto?.toFixed(2) ?? 'N/A'}</span></div>
                <div className="summary-item"><strong>Renta</strong><span>S/ {declaracion.rentaPagoCuenta?.toFixed(2) ?? 'N/A'}</span></div>
            </div>

            
            <h3>Formularios y Reportes Exportables</h3>
            <ul className="file-list">
              <li>
                <strong>Borrador de CÃ¡lculo</strong>
                <button
                  onClick={() => handleDownload('borrador', `BorradorCalculo_${declaracion.periodo}.xlsx`)}
                  disabled={downloading}
                  className="btn-download"
                >
                  {downloading === 'borrador' ? 'Descargando...' : 'Descargar XLSX'}
                </button>
              </li>
              <li>
                <strong>Formulario 621 (PDT)</strong>
                <button
                   onClick={() => handleDownload('form621', declaracion.form621Pdf || `Form621_${declaracion.periodo}.pdf`)}
                   disabled={downloading}
                   className="btn-download"
                >
                   {downloading === 'form621' ? 'Descargando...' : 'Descargar PDF'}
                </button>
              </li>
              <li>
                <strong>Resumen IGV</strong>
                <button
                   onClick={() => handleDownload('resumen', declaracion.resumenIgvPdf || `ResumenIGV_${declaracion.periodo}.pdf`)}
                   disabled={downloading}
                   className="btn-download"
                 >
                   {downloading === 'resumen' ? 'Descargando...' : 'Descargar PDF'}
                 </button>
              </li>
            </ul>

            
            <h3>RevisiÃ³n y AprobaciÃ³n Final</h3>

            {declaracion.estado === 'PENDIENTE_APROBACION' ? (
              <div className="action-buttons">
                <button
                  className="btn-approve"
                  onClick={() => handleAprobar(true)}
                  disabled={loading || downloading}
                >
                  {loading ? 'Procesando...' : 'Aprobar'}
                </button>
                <button
                  className="btn-reject"
                  onClick={() => handleAprobar(false)}
                  disabled={loading || downloading}
                >
                  {loading ? 'Procesando...' : 'Solicitar Ajustes'}
                </button>
              </div>
            ) : declaracion.estado === 'APROBADO_LISTO_PRESENTAR' ? (
                 <button
                    onClick={() => handleDownload('paquete', declaracion.paqueteZip || `PaqueteDeclaracion_${declaracion.periodo}.zip`)}
                    disabled={downloading}
                    className="btn-submit-final"
                 >
                    {downloading === 'paquete' ? 'Descargando...' : 'Descargar PaqueteDeclaracion.zip'}
                 </button>
            ) : (
                <p style={{color: '#991b1b', fontWeight: '600'}}>DeclaraciÃ³n Rechazada. Requiere ajustes.</p>
            )}
          </div>
        </div>
      )}
    </div>
  );
}
'''

### features/tax/pages/TaxConfigPage.jsx
'''
import React, { useState, useEffect } from "react";
import { useApiClient } from "@api/tax";
import '../styles/TaxConfigPage.css';

export default function TaxConfigPage() {
  const [step, setStep] = useState(1); // 1: Perfil, 2: ParÃ¡metros, 3: CatÃ¡logo
  const [loading, setLoading] = useState(true);
  
  // Formularios
  const [perfil, setPerfil] = useState({
    ruc: "",
    razonSocial: "",
    regimen: "RÃ©gimen General", // Valor por defecto
    domicilio: "",
    representanteLegal: "",
    cuentaBancaria: "",
  });
  
  const [params, setParams] = useState({
    tasaIgv: 18.0,
    reglasRedondeo: "COMERCIAL",
    formatoExportacion: "PDT_SUNAT",
  });
  
  const [catalogoFile, setCatalogoFile] = useState(null);
  const [configStatus, setConfigStatus] = useState({
    contribuyente: null,
    parametros: null,
    cantidadProductos: 0
  });

  const [message, setMessage] = useState({ type: "", text: "" });

  const api = useApiClient();

  // Cargar estado inicial
  useEffect(() => {
    api.getConfiguracion()
      .then(data => {
        setConfigStatus(data);
        if (data.contribuyente) {
          setPerfil(data.contribuyente);
        }
        if (data.parametros) {
          setParams(data.parametros);
        }
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error al cargar: ${err.message}` });
        setLoading(false);
      });
  }, []);

  const handlePerfilChange = (e) => {
    setPerfil({ ...perfil, [e.target.name]: e.target.value });
  };

  const handleParamsChange = (e) => {
    setParams({ ...params, [e.target.name]: e.target.value });
  };
  
  const handleFileChange = (e) => {
    setCatalogoFile(e.target.files[0]);
  };

  const handleSavePerfil = (e) => {
    e.preventDefault();
    setLoading(true);
    setMessage({ type: "", text: "" });
    api.guardarContribuyente(perfil)
      .then(data => {
        setConfigStatus(data);
        setMessage({ type: "success", text: "Perfil guardado exitosamente." });
        setStep(2);
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: err.message });
        setLoading(false);
      });
  };
  
  const handleSaveParams = (e) => {
    e.preventDefault();
    setLoading(true);
    setMessage({ type: "", text: "" });
    api.guardarParametros(params)
      .then(data => {
        setConfigStatus(data);
        setMessage({ type: "success", text: "ParÃ¡metros guardados y versionados." });
        setStep(3);
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: err.message });
        setLoading(false);
      });
  };

  const handleUploadCatalogo = (e) => {
    e.preventDefault();
    if (!catalogoFile) {
        setMessage({ type: "error", text: "Debe seleccionar un archivo CSV." });
        return;
    }
    
    setLoading(true);
    setMessage({ type: "", text: "" });
    
    const formData = new FormData();
    formData.append("file", catalogoFile);

    api.subirCatalogo(formData)
      .then(response => {
        setMessage({ type: "success", text: response.message });
        // Recargar status
        api.getConfiguracion().then(setConfigStatus);
        setLoading(false);
      })
      .catch(err => {
        setMessage({ type: "error", text: `Error de ValidaciÃ³n: ${err.message}` });
        setLoading(false);
      });
  };
  
  if (loading && !configStatus.contribuyente) return <p className="loading-text">Cargando configuraciÃ³n...</p>;

  return (
    <div className="tax-config-page">
      <h1>
        ConfiguraciÃ³n Tributaria â€“ Perfil del Contribuyente
      </h1>

      {message.text && (
        <div className={`message-box ${message.type === 'success' ? 'success' : 'error'}`}>
          {message.text}
        </div>
      )}

      {/* NavegaciÃ³n por Pasos */}
      <div className="step-navigation">
        <button onClick={() => setStep(1)} className={`step-button ${step === 1 ? 'active' : ''}`}>
          Paso 1: Perfil Contribuyente
        </button>
        <button onClick={() => setStep(2)} disabled={!configStatus.contribuyente} className={`step-button ${step === 2 ? 'active' : ''}`}>
          Paso 2: ParÃ¡metros
        </button>
        <button onClick={() => setStep(3)} disabled={!configStatus.parametros} className={`step-button ${step === 3 ? 'active' : ''}`}>
          Paso 3: CatÃ¡logo
        </button>
      </div>

      {step === 1 && (
        <form onSubmit={handleSavePerfil} className="tax-form-container">
          <h2 className="font-semibold text-lg mb-4">Alta de Contribuyente</h2>
          <div className="grid grid-cols-2 gap-4">
            <input name="ruc" value={perfil.ruc} onChange={handlePerfilChange} className="border p-2 rounded" placeholder="RUC (11 dÃ­gitos)" required />
            <input name="razonSocial" value={perfil.razonSocial} onChange={handlePerfilChange} className="border p-2 rounded" placeholder="RazÃ³n Social" required />
            <select name="regimen" value={perfil.regimen} onChange={handlePerfilChange} className="border p-2 rounded">
                <option value="RÃ©gimen General">RÃ©gimen General</option>
                <option value="RÃ©gimen MYPE">RÃ©gimen MYPE Tributario</option>
                <option value="RÃ©gimen Especial">RÃ©gimen Especial de Renta</option>
            </select>
            <input name="domicilio" value={perfil.domicilio} onChange={handlePerfilChange} className="border p-2 rounded" placeholder="Domicilio Fiscal" />
            <input name="cuentaBancaria" value={perfil.cuentaBancaria} onChange={handlePerfilChange} className="border p-2 rounded" placeholder="Cuenta Bancaria" />
            <input name="representanteLegal" value={perfil.representanteLegal} onChange={handlePerfilChange} placeholder="Representante Legal" />
          </div>
          <button type="submit" disabled={loading} className="btn-submit">
            {loading ? "Guardando..." : "Guardar y continuar (Paso 2)"}
          </button>
        </form>
      )}

      {step === 2 && (
        <form onSubmit={handleSaveParams} className="tax-form-container">
          <h2>ParÃ¡metros Tributarios MÃ­nimos</h2>
          <p>Al guardar, se crearÃ¡ una nueva versiÃ³n de los parÃ¡metros.</p>
          <div className="form-grid">
            <input type="number" step="0.01" name="tasaIgv" value={params.tasaIgv} onChange={handleParamsChange} placeholder="Porcentaje IGV (ej: 18.0)" />
            <input name="reglasRedondeo" value={params.reglasRedondeo} onChange={handleParamsChange} placeholder="Reglas de Redondeo" />
            <input name="formatoExportacion" value={params.formatoExportacion} onChange={handleParamsChange} placeholder="Formato ExportaciÃ³n" />
          </div>
          <button type="submit" disabled={loading} className="btn-submit">
            {loading ? "Guardando..." : "Confirmar y continuar (Paso 3)"}
          </button>
        </form>
      )}

      {step === 3 && (
        <form onSubmit={handleUploadCatalogo} className="tax-form-container">
          <h2>Carga de CatÃ¡logo de Productos/Servicios</h2>
          <p>Productos actuales en BD: <strong>{configStatus.cantidadProductos}</strong></p>
          <input type="file" name="file" onChange={handleFileChange} accept=".csv" />
          <p>
            Sube un archivo <code>CatalogoCarga.csv</code> (Campos: codigo, descripcion, precio_unitario, afectacion_igv).
          </p>
          <button type="submit" disabled={loading} className="btn-submit green">
            {loading ? "Validando y Guardando..." : "Validar y Activar Perfil"}
          </button>
        </form>
      )}
    </div>
  );
}
'''

### hooks/useAuth.js
'''
import { useContext } from 'react';
import { AuthContext } from '../contexts/AuthContext';

// Hook personalizado que exporta todas las funciones del contexto
export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
};

// Hook especÃ­fico para operaciones de autenticaciÃ³n
export const useAuthOperations = () => {
  const { login, logout, validateToken } = useAuth();
  
  return {
    login,
    logout,
    validateToken
  };
};

// Hook especÃ­fico para informaciÃ³n del usuario
export const useUserInfo = () => {
  const { user, isAuthenticated, loading, userName, userEmail, userRole } = useAuth();
  
  return {
    user,
    isAuthenticated,
    loading,
    userName,
    userEmail,
    userRole
  };
};

// Hook bÃ¡sico para permisos (versiÃ³n simple)
export const useBasicPermissions = () => {
  const { hasPermission, hasAnyPermission, hasRole, hasAnyRole, permissions, userRole } = useAuth();
  
  return {
    hasPermission,
    hasAnyPermission,
    hasRole,
    hasAnyRole,
    permissions,
    userRole
  };
};

export default useAuth;
'''

### hooks/usePermissions.js
'''
import { useAuth } from './useAuth';

// Hook especÃ­fico para validaciÃ³n de permisos
export const usePermissions = () => {
  const { hasPermission, hasAnyPermission, hasRole, hasAnyRole, permissions, userRole } = useAuth();
  
  // Funciones adicionales para casos especÃ­ficos del negocio
  const canAccessTaxModule = () => {
    return hasRole('ADMIN_TRIBUTARIO');
  };
  
  const canAccessPayrollModule = () => {
    return hasRole('GESTOR_PLANILLA');
  };
  
  const canAccessHiringModule = () => {
    return hasRole('GESTOR_CONTRATACION');
  };
  
  const canManageReports = () => {
    return hasAnyPermission(['view_tax_reports', 'generate_payroll_reports', 'view_hiring_reports']);
  };
  
  const canAccessDashboard = () => {
    return hasPermission('view_dashboard');
  };
  
  const canManageEmployees = () => {
    return hasAnyPermission(['manage_employees', 'manage_payroll_novelties']);
  };
  
  return {
    hasPermission,
    hasAnyPermission,
    hasRole,
    hasAnyRole,
    permissions,
    userRole,
    // Funciones especÃ­ficas del dominio
    canAccessTaxModule,
    canAccessPayrollModule,
    canAccessHiringModule,
    canManageReports,
    canAccessDashboard,
    canManageEmployees
  };
};
'''

### layouts/AuthenticatedDashboardLayout.jsx
'''
import React from 'react';
import { useAuth } from '../hooks/useAuth';
import { Navigate, Outlet } from 'react-router-dom';
import Sidebar from '../components/ui/SideBar';
import TopNavbar from '../components/ui/TopNavbar';
import '../components/ui/Sidebar.css';
import '../components/ui/TopNavbar.css';
import './DashboardLayout.css';

/**
 * Layout principal del dashboard con autenticaciÃ³n
 */
const AuthenticatedDashboardLayout = () => {
  const { isAuthenticated, loading, user } = useAuth();

  // Mostrar loading mientras se valida la autenticaciÃ³n
  if (loading) {
    return (
      <div className="dashboard-loading">
        <div className="loading-spinner">
          <div className="spinner"></div>
          <p>Cargando dashboard...</p>
        </div>
      </div>
    );
  }

  // Si no estÃ¡ autenticado, redirigir al login
  if (!isAuthenticated) {
    return <Navigate to="/login" replace />;
  }

  return (
    <div className="dashboard-layout">
      {/* Sidebar con navegaciÃ³n por rol */}
      <Sidebar />
      
      {/* Contenido principal */}
      <div className="main-content">
        {/* Navbar superior */}
        <TopNavbar />
        
        {/* Ãrea de contenido */}
        <main className="content-area">
          <div className="content-wrapper">
            <Outlet />
          </div>
        </main>
      </div>
    </div>
  );
};

export default AuthenticatedDashboardLayout;
'''

### pages/NotFoundPage.jsx
'''
import React from 'react';
import { Link } from 'react-router-dom';

const NotFoundPage = () => {
  return (
    <div className="not-found-container">
      <div className="not-found-content">
        <div className="not-found-icon">
          <span>404</span>
        </div>
        <h1>PÃ¡gina no encontrada</h1>
        <p>Lo sentimos, la pÃ¡gina que buscas no existe o ha sido movida.</p>
        <div className="not-found-actions">
          <Link to="/dashboard" className="btn btn-primary">
            Ir al Dashboard
          </Link>
          <button onClick={() => window.history.back()} className="btn btn-secondary">
            Volver atrÃ¡s
          </button>
        </div>
      </div>
      
      <style jsx>{`
        .not-found-container {
          display: flex;
          align-items: center;
          justify-content: center;
          min-height: 100vh;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          padding: 20px;
        }
        
        .not-found-content {
          text-align: center;
          background: white;
          padding: 60px 40px;
          border-radius: 20px;
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
          max-width: 500px;
          width: 100%;
        }
        
        .not-found-icon {
          font-size: 6rem;
          font-weight: 700;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          margin-bottom: 30px;
        }
        
        .not-found-content h1 {
          font-size: 2rem;
          color: #1f2937;
          margin-bottom: 16px;
        }
        
        .not-found-content p {
          color: #6b7280;
          font-size: 1.1rem;
          margin-bottom: 40px;
          line-height: 1.6;
        }
        
        .not-found-actions {
          display: flex;
          gap: 16px;
          justify-content: center;
          flex-wrap: wrap;
        }
        
        .btn {
          padding: 12px 24px;
          border-radius: 8px;
          font-weight: 500;
          text-decoration: none;
          border: none;
          cursor: pointer;
          transition: all 0.2s ease;
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }
        
        .btn-primary {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
        }
        
        .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .btn-secondary {
          background: #6b7280;
          color: white;
        }
        
        .btn-secondary:hover {
          background: #4b5563;
          transform: translateY(-2px);
        }
        
        @media (max-width: 480px) {
          .not-found-content {
            padding: 40px 20px;
          }
          
          .not-found-icon {
            font-size: 4rem;
          }
          
          .not-found-content h1 {
            font-size: 1.5rem;
          }
          
          .not-found-actions {
            flex-direction: column;
          }
        }
      `}</style>
    </div>
  );
};

export default NotFoundPage;
'''

### pages/auth/LoginPage.jsx
'''
import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../../hooks/useAuth';
import LoginForm from '../../components/auth/LoginForm';

const LoginPage = () => {
  const { isAuthenticated, loading } = useAuth();
  const navigate = useNavigate();

  useEffect(() => {
    // Si el usuario ya estÃ¡ autenticado, redirigir al dashboard
    if (isAuthenticated && !loading) {
      navigate('/dashboard', { replace: true });
    }
  }, [isAuthenticated, loading, navigate]);

  // Mostrar loading si estÃ¡ validando
  if (loading) {
    return (
      <div className="loading-container">
        <div className="loading-spinner">
          <div className="spinner"></div>
          <p>Cargando...</p>
        </div>
      </div>
    );
  }

  // Si no estÃ¡ autenticado, mostrar el formulario de login
  if (!isAuthenticated) {
    return <LoginForm />;
  }

  // Mientras redirige, mostrar un mensaje
  return (
    <div className="loading-container">
      <div className="loading-spinner">
        <div className="spinner"></div>
        <p>Redirigiendo...</p>
      </div>
    </div>
  );
};

export default LoginPage;
'''

### routes/AuthenticatedAppRoutes.jsx
'''
import React from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { AuthProvider } from '../contexts/AuthContext';
import ProtectedRoute from '../components/auth/ProtectedRoute';
import AuthenticatedDashboardLayout from '../layouts/AuthenticatedDashboardLayout';

// PÃ¡ginas de autenticaciÃ³n
import LoginPage from '../pages/auth/LoginPage';

// PÃ¡ginas principales
import DashboardPage from '../features/employees/pages/DashboardPage';
import EditProfilePage from '../features/employees/pages/EditProfilePage';
import PayrollSelfServicePage from '../features/employees/pages/PayrollSelfServicePage';
import NotFoundPage from '../pages/NotFoundPage';

// MÃ³dulo Tributario (ADMIN_TRIBUTARIO)
import TaxConfigPage from '../features/tax/pages/TaxConfigPage';
import DailyOpsPage from '../features/tax/pages/DailyOpsPage';
import MonthlyClosingPage from '../features/tax/pages/MonthlyClosingPage';

// MÃ³dulo Planilla (GESTOR_PLANILLA)
import LiquidationProcessPage from '../features/payroll/pages/LiquidationProcessPage';
import MastersConfigPage from '../features/payroll/pages/MastersConfigPage';
import PayrollDashboardPage from '../features/payroll/pages/PayrollDashboardPage';
import ReportsPage from '../features/payroll/pages/ReportsPage';

// MÃ³dulo Convocatorias (GESTOR_CONTRATACION)
import ConvocatoriasListPage from '../features/convocatorias/pages/ConvocatoriasListPage';
import CandidatosListPage from '../features/convocatorias/pages/CandidatosListPage';
import PostulacionesListPage from '../features/convocatorias/pages/PostulacionesListPage';
import EntrevistasListPage from '../features/convocatorias/pages/EntrevistasListPage';

// Componentes especÃ­ficos de planilla
import EmployeeListPage from '../features/payroll/pages/EmployeeListPage';
import EmployeeFormPage from '../features/payroll/pages/EmployeeFormPage';
import EmployeeDetailPage from '../features/payroll/pages/EmployeeDetailPage';
import EmployeePayrollDetails from '../features/payroll/components/masters/EmployeePayrollDetails';
import LegalParametersTable from '../features/payroll/components/masters/LegalParametersTable';
import MonthlyNoveltyEntry from '../features/payroll/components/processes/MonthlyNoveltyEntry';
import PrePayrollReviewTable from '../features/payroll/components/processes/PrePayrollReviewTable';
import PayrollSummaryReportPage from '../features/payroll/components/reports/PayrollSummaryReportPage';
import OutputFilesPage from '../features/payroll/components/reports/OutputFilesPage';
import PayrollListPage from '../features/payroll/pages/PayrollListPage';
import PayrollFormPage from '../features/payroll/pages/PayrollFormPage';
import PayrollDetailPage from '../features/payroll/pages/PayrollDetailPage';

// Rutas del mÃ³dulo tributario
const TaxRoutes = () => (
  <Routes>
    <Route index element={<Navigate to="config" replace />} />
    <Route path="config" element={<TaxConfigPage />} />
    <Route path="daily" element={<DailyOpsPage />} />
    <Route path="closing" element={<MonthlyClosingPage />} />
  </Routes>
);

// Rutas del mÃ³dulo de planilla
const PayrollRoutes = () => (
  <Routes>
    <Route index element={<Navigate to="dashboard" replace />} />
    <Route path="dashboard" element={<PayrollDashboardPage />} />
    <Route path="list" element={<PayrollListPage />} />
    <Route path="new" element={<PayrollFormPage />} />
    <Route path=":id" element={<PayrollDetailPage />} />
    <Route path=":id/edit" element={<PayrollFormPage />} />
    <Route path="novelties" element={<MonthlyNoveltyEntry />} />
    <Route path="review" element={<PrePayrollReviewTable />} />
    <Route path="liquidation" element={<LiquidationProcessPage />} />
    <Route path="outputs" element={<OutputFilesPage />} />
  </Routes>
);

// Rutas de maestros y configuraciÃ³n
const MastersRoutes = () => (
  <Routes>
    <Route index element={<Navigate to="config" replace />} />
    <Route path="legal-parameters" element={<LegalParametersTable />} />
    <Route path="employee-payroll" element={<EmployeePayrollDetails />} />
    <Route path="config" element={<MastersConfigPage />} />
    <Route path="employees" element={<EmployeeListPage />} />
    <Route path="employees/new" element={<EmployeeFormPage />} />
    <Route path="employees/:id" element={<EmployeeDetailPage />} />
    <Route path="employees/:id/edit" element={<EmployeeFormPage />} />
  </Routes>
);

// Rutas de reportes
const ReportsRoutes = () => (
  <Routes>
    <Route index element={<Navigate to="summary" replace />} />
    <Route path="summary" element={<PayrollSummaryReportPage />} />
    <Route path="output-files" element={<OutputFilesPage />} />
    <Route path="payroll" element={<ReportsPage />} />
  </Routes>
);

// Rutas de contrataciÃ³n
const HiringRoutes = () => (
  <Routes>
    <Route index element={<Navigate to="convocatorias" replace />} />
    <Route path="convocatorias" element={<ConvocatoriasListPage />} />
    <Route path="candidatos" element={<CandidatosListPage />} />
    <Route path="postulaciones" element={<PostulacionesListPage />} />
    <Route path="entrevistas" element={<EntrevistasListPage />} />
  </Routes>
);

export default function AppRoutes() {
  console.log('ğŸ¯ AppRoutes rendering...');
  
  return (
    <BrowserRouter>
      <AuthProvider>
        <Routes>
          {/* Ruta pÃºblica de login */}
          <Route path="/login" element={<LoginPage />} />
          
          {/* Rutas protegidas con layout */}
          <Route path="/" element={
            <ProtectedRoute>
              <AuthenticatedDashboardLayout />
            </ProtectedRoute>
          }>
            {/* Dashboard principal */}
            <Route index element={<Navigate to="/dashboard" replace />} />
            <Route path="/dashboard" element={<DashboardPage />} />
            
            {/* Perfil de usuario */}
            <Route path="/profile" element={<EditProfilePage />} />
            
            {/* Auto-servicio de empleados */}
            <Route path="/self-service" element={<PayrollSelfServicePage />} />
            
            {/* MÃ³dulo Tributario - Solo ADMIN_TRIBUTARIO */}
            <Route path="/tax/*" element={
              <ProtectedRoute requiredRole="ADMIN_TRIBUTARIO">
                <TaxRoutes />
              </ProtectedRoute>
            } />
            
            {/* MÃ³dulo de Planilla - Solo GESTOR_PLANILLA */}
            <Route path="/payroll/*" element={
              <ProtectedRoute requiredRole="GESTOR_PLANILLA">
                <PayrollRoutes />
              </ProtectedRoute>
            } />
            
            {/* Maestros y ConfiguraciÃ³n - Solo GESTOR_PLANILLA */}
            <Route path="/masters/*" element={
              <ProtectedRoute requiredRole="GESTOR_PLANILLA">
                <MastersRoutes />
              </ProtectedRoute>
            } />
            
            {/* Reportes - Solo GESTOR_PLANILLA */}
            <Route path="/reports/*" element={
              <ProtectedRoute requiredRole="GESTOR_PLANILLA">
                <ReportsRoutes />
              </ProtectedRoute>
            } />
            
            {/* MÃ³dulo de ContrataciÃ³n - Solo GESTOR_CONTRATACION */}
            <Route path="/hiring/*" element={
              <ProtectedRoute requiredRole="GESTOR_CONTRATACION">
                <HiringRoutes />
              </ProtectedRoute>
            } />
          </Route>
          
          {/* PÃ¡gina 404 */}
          <Route path="/404" element={<NotFoundPage />} />
          
          {/* Redirecciones */}
          <Route path="*" element={<Navigate to="/404" replace />} />
        </Routes>
      </AuthProvider>
    </BrowserRouter>
  );
}
'''
